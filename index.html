<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipe Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #fdf2f8 0%, #fce7f3 50%, #fbbf24 100%);
        }
        .btn-primary {
            background: linear-gradient(135deg, #ec4899 0%, #f43f5e 100%);
            color: white;
            font-weight: 600;
            padding: 12px 24px;
            border-radius: 8px;
            transition: all 0.3s;
            transform: scale(1);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .btn-primary:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .input-field {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #fce7f3;
            border-radius: 8px;
            outline: none;
            transition: all 0.2s;
            background: rgba(255, 255, 255, 0.9);
        }
        .input-field:focus {
            ring: 2px;
            ring-color: #ec4899;
            border-color: transparent;
        }
        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            border: 1px solid #fce7f3;
        }
        .recipe-card {
            animation: slideIn 0.5s ease-out;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .ingredient-tag {
            background: linear-gradient(135deg, #ec4899 0%, #f43f5e 100%);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
        }
        .step-number {
            background: linear-gradient(135deg, #ec4899 0%, #f43f5e 100%);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">Recipe Generator</h1>
            <p class="text-gray-600">Enter your ingredients and get delicious recipes!</p>
            

            
            <!-- Premium Banner -->
            <div id="premium-banner" class="card p-4 mt-4 bg-gradient-to-r from-yellow-100 to-orange-100 border-2 border-yellow-200">
                <div class="flex items-center justify-center gap-4">
                    <div>
                        <h3 class="text-lg font-bold text-gray-800">Upgrade to Premium</h3>
                        <p class="text-sm text-gray-600">Unlock advanced features and unlimited recipes!</p>
                    </div>
                    <button onclick="showPremiumModal()" class="btn-primary px-4 py-2 text-sm">
                        Upgrade Now
                    </button>
                </div>
            </div>
        </div>

        <!-- Input Form -->
        <div class="card p-6 mb-6">
            <div class="mb-4">
                <label class="block text-gray-700 font-semibold mb-2">Ingredients:</label>
                <div id="ingredients-container">
                    <div class="flex gap-2 mb-2">
                        <input type="text" class="input-field flex-1" placeholder="Enter an ingredient..." id="ingredient-0">
                        <button onclick="addIngredient()" class="btn-primary">+</button>
                    </div>
                </div>
            </div>

            <div class="mb-4">
                <label class="block text-gray-700 font-semibold mb-2">Dietary Restrictions:</label>
                <div class="flex flex-wrap gap-2">
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" value="vegetarian"> Vegetarian
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" value="vegan"> Vegan
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" value="gluten-free"> Gluten-Free
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" value="dairy-free"> Dairy-Free
                    </label>
                </div>
            </div>

            <button onclick="generateRecipe()" class="btn-primary w-full py-3">
                Generate Recipe
            </button>
            <button onclick="testRecipeGeneration()" class="btn-primary w-full mt-2 bg-blue-500">
                Test Recipe Generation
            </button>
        </div>

        <!-- Recipe Display -->
        <div id="recipe-display" class="hidden">
            <div class="card p-8 recipe-card">
                <h2 id="recipe-title" class="text-3xl font-bold text-gray-800 mb-4"></h2>
                <p id="recipe-description" class="text-gray-600 mb-6"></p>
                
                <div class="grid md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <h3 class="text-xl font-semibold text-gray-800 mb-3">Ingredients:</h3>
                        <ul id="recipe-ingredients" class="space-y-2"></ul>
                    </div>
                    <div>
                        <h3 class="text-xl font-semibold text-gray-800 mb-3">Instructions:</h3>
                        <ol id="recipe-instructions" class="space-y-3"></ol>
                    </div>
                </div>

                <div class="flex flex-wrap gap-4 text-sm text-gray-600">
                    <div class="flex items-center">
                        <span class="font-semibold">‚è±Ô∏è Cooking Time:</span>
                        <span id="cooking-time" class="ml-2"></span>
                    </div>
                    <div class="flex items-center">
                        <span class="font-semibold">üë• Servings:</span>
                        <span id="servings" class="ml-2"></span>
                    </div>
                    <div class="flex items-center">
                        <span class="font-semibold">üî• Calories:</span>
                        <span id="calories" class="ml-2"></span>
                    </div>
                </div>
            </div>
        </div>
        

        
        <!-- Premium Modal -->
        <div id="premium-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-3xl font-bold text-gray-800">Premium Features</h2>
                    <button onclick="hidePremiumModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                </div>
                
                <!-- Premium Plans -->
                <div class="grid md:grid-cols-2 gap-6 mb-6">
                    <div class="border-2 border-gray-200 rounded-lg p-6 hover:border-pink-300 transition-colors">
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Monthly Plan</h3>
                        <div class="text-3xl font-bold text-pink-500 mb-2">$9.99<span class="text-lg text-gray-500">/month</span></div>
                        <ul class="space-y-2 text-gray-600 mb-4">
                            <li>‚úì Unlimited recipe generation</li>
                            <li>‚úì Advanced dietary filters</li>
                            <li>‚úì Recipe scaling (2-12 servings)</li>
                            <li>‚úì Nutritional information</li>
                            <li>‚úì Recipe collections</li>
                            <li>‚úì Ad-free experience</li>
                        </ul>
                        <button onclick="selectPlan('monthly')" class="btn-primary w-full">Choose Monthly</button>
                    </div>
                    
                    <div class="border-2 border-pink-300 rounded-lg p-6 bg-pink-50 relative">
                        <div class="absolute -top-3 left-1/2 transform -translate-x-1/2 bg-pink-500 text-white px-4 py-1 rounded-full text-sm font-bold">BEST VALUE</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Yearly Plan</h3>
                        <div class="text-3xl font-bold text-pink-500 mb-2">$79.99<span class="text-lg text-gray-500">/year</span></div>
                        <div class="text-sm text-green-600 mb-2">Save 33% compared to monthly!</div>
                        <ul class="space-y-2 text-gray-600 mb-4">
                            <li>‚úì Everything in Monthly</li>
                            <li>‚úì Meal planning tools</li>
                            <li>‚úì Shopping list generator</li>
                            <li>‚úì Recipe sharing</li>
                            <li>‚úì Priority support</li>
                            <li>‚úì Early access to new features</li>
                        </ul>
                        <button onclick="selectPlan('yearly')" class="btn-primary w-full">Choose Yearly</button>
                    </div>
                </div>
                
                <!-- Payment Form -->
                <div id="payment-form" class="hidden">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Payment Information</h3>
                    <div class="grid md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2">Email Address</label>
                            <input type="email" id="customer-email" class="input-field" placeholder="your@email.com" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2">Card Number</label>
                            <input type="text" id="card-number" class="input-field" placeholder="1234 5678 9012 3456">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2">Expiry Date</label>
                            <input type="text" id="card-expiry" class="input-field" placeholder="MM/YY">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2">CVV</label>
                            <input type="text" id="card-cvv" class="input-field" placeholder="123">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2">Name on Card</label>
                            <input type="text" id="card-name" class="input-field" placeholder="John Doe">
                        </div>
                    </div>
                    <div class="flex justify-between items-center">
                        <div class="text-lg font-bold text-gray-800">
                            Total: <span id="plan-price">$9.99</span>
                        </div>
                        <button onclick="processPayment()" class="btn-primary px-8 py-3">
                            Pay Now
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Reset App Link -->
        <div class="text-center mt-8">
            <button onclick="resetApp()" class="text-sm text-gray-500 hover:text-gray-700 underline">
                Reset App (Clear All Data)
            </button>
        </div>
    </div>

    <script>
        let ingredientCount = 1;
        let isPremium = false;
        let selectedPlan = '';
        let servings = 4;


        // Check if user is premium on page load
        window.addEventListener('load', function() {
            console.log('Page loaded - Authentication system active');
            
            // Check if premium status is stored
            // Check if premium status is stored
            const premiumStatus = localStorage.getItem('isPremium');
            if (premiumStatus === 'true') {
                isPremium = true;
                // Hide the premium banner and show premium features
                const banner = document.getElementById('premium-banner');
                if (banner) {
                    banner.classList.add('hidden');
                }
                // Add premium features to the form
                addPremiumFeatures();
            }
            


        function addIngredient() {
            const container = document.getElementById('ingredients-container');
            const newDiv = document.createElement('div');
            newDiv.className = 'flex gap-2 mb-2';
            newDiv.innerHTML = `
                <input type="text" class="input-field flex-1" placeholder="Enter an ingredient..." id="ingredient-${ingredientCount}">
                <button onclick="removeIngredient(this)" class="btn-primary">-</button>
            `;
            container.appendChild(newDiv);
            ingredientCount++;
        }

        function removeIngredient(button) {
            button.parentElement.remove();
            // Update ingredient count to reflect actual number of inputs
            const remainingInputs = document.querySelectorAll('input[id^="ingredient-"]');
            ingredientCount = remainingInputs.length;
        }

        function generateRecipe() {
            console.log('generateRecipe called');
            const ingredients = [];
            // Get all ingredient inputs that actually exist and have values
            const ingredientInputs = document.querySelectorAll('input[id^="ingredient-"]');
            console.log('Found ingredient inputs:', ingredientInputs.length);
            ingredientInputs.forEach(input => {
                if (input.value.trim()) {
                    ingredients.push(input.value.trim());
                    console.log('Added ingredient:', input.value.trim());
                }
            });

            if (ingredients.length === 0) {
                alert('Please add at least one ingredient!');
                return;
            }

            // Get dietary restrictions
            const restrictions = [];
            document.querySelectorAll('input[type="checkbox"]:checked').forEach(cb => {
                restrictions.push(cb.value);
            });
            console.log('Dietary restrictions:', restrictions);

            // Generate recipe based on ingredients
            console.log('Generating recipe for ingredients:', ingredients);
            const recipe = generateRecipeFromIngredients(ingredients, restrictions);
            console.log('Generated recipe:', recipe);
            displayRecipe(recipe);
        }

        function generateRecipeFromIngredients(ingredients, restrictions) {
            // For multiple ingredients, always create a multi-ingredient recipe
            if (ingredients.length > 1) {
                return createMultiIngredientRecipe(ingredients, restrictions);
            }
            
            const recipes = {
                'chicken': {
                    title: 'Classic Chicken Cacciatore',
                    description: 'Traditional Italian hunter-style chicken with tomatoes and herbs',
                    ingredients: [
                        { item: 'chicken pieces (legs and thighs)', amount: '3', unit: 'pounds' },
                        { item: 'tomatoes', amount: '4', unit: 'medium' },
                        { item: 'onion', amount: '1', unit: 'large' },
                        { item: 'garlic', amount: '4', unit: 'cloves' },
                        { item: 'bell peppers', amount: '2', unit: 'medium' },
                        { item: 'olive oil', amount: '3', unit: 'tablespoons' },
                        { item: 'dried oregano', amount: '1', unit: 'teaspoon' },
                        { item: 'dried basil', amount: '1', unit: 'teaspoon' },
                        { item: 'red wine', amount: '1/2', unit: 'cup' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Season chicken with salt and pepper',
                        'Heat olive oil in a large Dutch oven over medium heat',
                        'Brown chicken pieces on all sides, about 8 minutes',
                        'Remove chicken and set aside',
                        'Add chopped onion and garlic, cook until softened',
                        'Add chopped tomatoes and bell peppers',
                        'Add oregano, basil, and red wine',
                        'Return chicken to pot and simmer covered for 45 minutes',
                        'Serve hot with crusty bread or pasta'
                    ],
                    cookingTime: '1 hour 15 minutes',
                    servings: '6 servings',
                    calories: '380 calories per serving'
                },
                'pork': {
                    title: 'Traditional Chinese Sweet and Sour Pork',
                    description: 'Crispy pork with tangy sweet and sour sauce',
                    ingredients: [
                        { item: 'pork shoulder', amount: '2', unit: 'pounds' },
                        { item: 'pineapple', amount: '1', unit: 'can' },
                        { item: 'bell peppers', amount: '2', unit: 'medium' },
                        { item: 'soy sauce', amount: '3', unit: 'tablespoons' },
                        { item: 'rice vinegar', amount: '2', unit: 'tablespoons' },
                        { item: 'sugar', amount: '1/4', unit: 'cup' },
                        { item: 'cornstarch', amount: '2', unit: 'tablespoons' },
                        { item: 'vegetable oil', amount: '1/2', unit: 'cup' }
                    ],
                    instructions: [
                        'Cut pork into bite-sized pieces and marinate in soy sauce',
                        'Heat oil in a wok and deep-fry pork until crispy',
                        'Remove pork and drain on paper towels',
                        'Saut√© bell peppers and pineapple in the same oil',
                        'Add vinegar, sugar, and cornstarch slurry',
                        'Return pork to wok and toss with sauce',
                        'Serve hot with steamed rice'
                    ],
                    cookingTime: '45 minutes',
                    servings: '4 servings',
                    calories: '520 calories per serving'
                },
                'lamb': {
                    title: 'Moroccan Lamb Tagine',
                    description: 'Slow-cooked lamb with aromatic spices and dried fruits',
                    ingredients: [
                        { item: 'lamb shoulder', amount: '2', unit: 'pounds' },
                        { item: 'apricots', amount: '1/2', unit: 'cup' },
                        { item: 'prunes', amount: '1/2', unit: 'cup' },
                        { item: 'onion', amount: '1', unit: 'large' },
                        { item: 'garlic', amount: '6', unit: 'cloves' },
                        { item: 'cinnamon', amount: '1', unit: 'stick' },
                        { item: 'cumin', amount: '2', unit: 'teaspoons' },
                        { item: 'honey', amount: '2', unit: 'tablespoons' }
                    ],
                    instructions: [
                        'Season lamb with salt and pepper',
                        'Brown lamb in oil in a tagine or Dutch oven',
                        'Add chopped onion and garlic',
                        'Add spices, honey, and dried fruits',
                        'Add water to cover and simmer for 2 hours',
                        'Serve with couscous and fresh herbs'
                    ],
                    cookingTime: '2 hours 30 minutes',
                    servings: '6 servings',
                    calories: '480 calories per serving'
                },
                'turkey': {
                    title: 'Thanksgiving Turkey with Herb Butter',
                    description: 'Classic roasted turkey with aromatic herb butter',
                    ingredients: [
                        { item: 'turkey', amount: '12', unit: 'pounds' },
                        { item: 'butter', amount: '1', unit: 'cup' },
                        { item: 'sage', amount: '1/4', unit: 'cup' },
                        { item: 'thyme', amount: '1/4', unit: 'cup' },
                        { item: 'rosemary', amount: '2', unit: 'sprigs' },
                        { item: 'garlic', amount: '8', unit: 'cloves' },
                        { item: 'onion', amount: '2', unit: 'large' },
                        { item: 'chicken broth', amount: '2', unit: 'cups' }
                    ],
                    instructions: [
                        'Preheat oven to 325¬∞F',
                        'Mix softened butter with chopped herbs and garlic',
                        'Loosen turkey skin and spread herb butter underneath',
                        'Stuff cavity with onion and herbs',
                        'Roast for 3-4 hours, basting every 30 minutes',
                        'Let rest for 20 minutes before carving'
                    ],
                    cookingTime: '4 hours',
                    servings: '12 servings',
                    calories: '380 calories per serving'
                },
                'shrimp': {
                    title: 'Thai Coconut Shrimp Curry',
                    description: 'Aromatic shrimp curry with coconut milk and Thai spices',
                    ingredients: [
                        { item: 'shrimp', amount: '1', unit: 'pound' },
                        { item: 'coconut milk', amount: '2', unit: 'cans' },
                        { item: 'lemongrass', amount: '3', unit: 'stalks' },
                        { item: 'kaffir lime leaves', amount: '6', unit: 'leaves' },
                        { item: 'red curry paste', amount: '2', unit: 'tablespoons' },
                        { item: 'fish sauce', amount: '2', unit: 'tablespoons' },
                        { item: 'palm sugar', amount: '1', unit: 'tablespoon' },
                        { item: 'basil', amount: '1/2', unit: 'cup' }
                    ],
                    instructions: [
                        'Heat oil in a wok and add curry paste',
                        'Add coconut milk and bring to simmer',
                        'Add lemongrass and lime leaves',
                        'Add shrimp and cook for 3 minutes',
                        'Add fish sauce and palm sugar',
                        'Garnish with basil and serve with rice'
                    ],
                    cookingTime: '20 minutes',
                    servings: '4 servings',
                    calories: '320 calories per serving'
                },
                'tofu': {
                    title: 'Japanese Agedashi Tofu',
                    description: 'Crispy fried tofu in savory dashi broth',
                    ingredients: [
                        { item: 'firm tofu', amount: '1', unit: 'block' },
                        { item: 'dashi stock', amount: '2', unit: 'cups' },
                        { item: 'soy sauce', amount: '3', unit: 'tablespoons' },
                        { item: 'mirin', amount: '2', unit: 'tablespoons' },
                        { item: 'potato starch', amount: '1/2', unit: 'cup' },
                        { item: 'green onions', amount: '4', unit: 'pieces' },
                        { item: 'bonito flakes', amount: '1/4', unit: 'cup' }
                    ],
                    instructions: [
                        'Cut tofu into cubes and drain well',
                        'Dredge tofu in potato starch',
                        'Deep-fry tofu until golden and crispy',
                        'Heat dashi with soy sauce and mirin',
                        'Place tofu in serving bowls',
                        'Pour hot broth over tofu',
                        'Garnish with green onions and bonito flakes'
                    ],
                    cookingTime: '15 minutes',
                    servings: '4 servings',
                    calories: '180 calories per serving'
                },
                'beef': {
                    title: 'Traditional Beef Bourguignon',
                    description: 'Classic French beef stew with red wine and mushrooms',
                    ingredients: [
                        { item: 'beef chuck roast', amount: '2', unit: 'pounds' },
                        { item: 'red wine', amount: '2', unit: 'cups' },
                        { item: 'beef broth', amount: '2', unit: 'cups' },
                        { item: 'mushrooms', amount: '1', unit: 'pound' },
                        { item: 'pearl onions', amount: '1', unit: 'cup' },
                        { item: 'carrots', amount: '4', unit: 'medium' },
                        { item: 'garlic', amount: '6', unit: 'cloves' },
                        { item: 'tomato paste', amount: '2', unit: 'tablespoons' },
                        { item: 'thyme', amount: '2', unit: 'sprigs' },
                        { item: 'bay leaves', amount: '2', unit: 'pieces' }
                    ],
                    instructions: [
                        'Cut beef into 2-inch cubes and season with salt and pepper',
                        'Heat oil in a large Dutch oven and brown beef in batches',
                        'Remove beef and add chopped onions and garlic',
                        'Add wine and scrape up browned bits from bottom',
                        'Add beef broth, tomato paste, thyme, and bay leaves',
                        'Return beef to pot and simmer covered for 2 hours',
                        'Add carrots, mushrooms, and pearl onions',
                        'Continue cooking for 30 minutes until vegetables are tender',
                        'Serve with mashed potatoes or crusty bread'
                    ],
                    cookingTime: '2 hours 30 minutes',
                    servings: '6 servings',
                    calories: '450 calories per serving'
                },
                'salmon': {
                    title: 'Traditional Scottish Salmon with Whisky Sauce',
                    description: 'Classic Scottish salmon with a rich whisky cream sauce',
                    ingredients: [
                        { item: 'salmon fillets', amount: '4', unit: 'pieces' },
                        { item: 'scottish whisky', amount: '1/4', unit: 'cup' },
                        { item: 'heavy cream', amount: '1', unit: 'cup' },
                        { item: 'butter', amount: '4', unit: 'tablespoons' },
                        { item: 'shallots', amount: '2', unit: 'medium' },
                        { item: 'dill', amount: '2', unit: 'tablespoons' },
                        { item: 'lemon', amount: '1', unit: 'whole' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Season salmon with salt and pepper',
                        'Heat butter in a large skillet over medium heat',
                        'Cook salmon skin-side down for 4 minutes',
                        'Flip and cook for 3 more minutes, then remove',
                        'Add chopped shallots to the same pan',
                        'Add whisky and let it reduce for 1 minute',
                        'Add cream and simmer until thickened',
                        'Stir in chopped dill and lemon juice',
                        'Pour sauce over salmon and serve'
                    ],
                    cookingTime: '20 minutes',
                    servings: '4 servings',
                    calories: '420 calories per serving'
                },
                'pasta': {
                    title: 'Authentic Carbonara',
                    description: 'Traditional Roman pasta with eggs, cheese, and pancetta',
                    ingredients: [
                        { item: 'spaghetti', amount: '1', unit: 'pound' },
                        { item: 'pancetta', amount: '8', unit: 'ounces' },
                        { item: 'eggs', amount: '4', unit: 'large' },
                        { item: 'pecorino romano', amount: '1', unit: 'cup' },
                        { item: 'black pepper', amount: '2', unit: 'teaspoons' },
                        { item: 'garlic', amount: '3', unit: 'cloves' },
                        { item: 'salt', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Bring a large pot of salted water to boil',
                        'Cook pasta according to package directions (8-10 minutes)',
                        'Meanwhile, melt butter in a large skillet over medium heat',
                        'Add minced garlic and cook for 1 minute until fragrant',
                        'Add cream and simmer for 3 minutes until slightly thickened',
                        'Stir in parmesan cheese until melted and smooth',
                        'Add cooked pasta and toss to coat evenly',
                        'Season with salt and pepper, serve immediately'
                    ],
                    cookingTime: '20 minutes',
                    servings: '4 servings',
                    calories: '580 calories per serving'
                },
                'tomato': {
                    title: 'Fresh Tomato Pasta',
                    description: 'Simple and delicious pasta with fresh tomatoes and basil',
                    ingredients: [
                        { item: 'spaghetti', amount: '1', unit: 'pound' },
                        { item: 'fresh tomatoes', amount: '4', unit: 'large' },
                        { item: 'fresh basil', amount: '1/2', unit: 'cup' },
                        { item: 'garlic', amount: '4', unit: 'cloves' },
                        { item: 'olive oil', amount: '1/4', unit: 'cup' },
                        { item: 'parmesan cheese', amount: '1/2', unit: 'cup' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Bring a large pot of salted water to boil',
                        'Cook spaghetti according to package directions',
                        'Meanwhile, dice tomatoes and mince garlic',
                        'Heat olive oil in a large skillet over medium heat',
                        'Add garlic and cook for 1 minute until fragrant',
                        'Add tomatoes and cook for 5 minutes until softened',
                        'Add cooked pasta and toss with basil',
                        'Top with parmesan cheese and serve'
                    ],
                    cookingTime: '20 minutes',
                    servings: '4 servings',
                    calories: '380 calories per serving'
                },
                'potato': {
                    title: 'Garlic Mashed Potatoes',
                    description: 'Creamy mashed potatoes with roasted garlic',
                    ingredients: [
                        { item: 'potatoes', amount: '3', unit: 'pounds' },
                        { item: 'butter', amount: '1/2', unit: 'cup' },
                        { item: 'milk', amount: '1/2', unit: 'cup' },
                        { item: 'garlic', amount: '6', unit: 'cloves' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Peel and cube potatoes, place in large pot',
                        'Cover with cold water and bring to boil',
                        'Cook for 15-20 minutes until tender',
                        'Meanwhile, roast garlic cloves in foil for 20 minutes',
                        'Drain potatoes and return to pot',
                        'Mash with butter, milk, and roasted garlic',
                        'Season with salt and pepper to taste'
                    ],
                    cookingTime: '30 minutes',
                    servings: '6 servings',
                    calories: '220 calories per serving'
                },
                'egg': {
                    title: 'Scrambled Eggs with Herbs',
                    description: 'Fluffy scrambled eggs with fresh herbs and cheese',
                    ingredients: [
                        { item: 'eggs', amount: '8', unit: 'large' },
                        { item: 'butter', amount: '2', unit: 'tablespoons' },
                        { item: 'milk', amount: '1/4', unit: 'cup' },
                        { item: 'fresh herbs', amount: '2', unit: 'tablespoons' },
                        { item: 'cheddar cheese', amount: '1/2', unit: 'cup' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Crack eggs into a bowl and whisk with milk',
                        'Melt butter in a large skillet over medium-low heat',
                        'Pour in egg mixture and let sit for 30 seconds',
                        'Gently stir with a spatula, folding eggs',
                        'Add herbs and cheese, continue cooking',
                        'Cook until just set but still moist',
                        'Season with salt and pepper, serve immediately'
                    ],
                    cookingTime: '10 minutes',
                    servings: '4 servings',
                    calories: '180 calories per serving'
                },
                'rice': {
                    title: 'Fried Rice',
                    description: 'Classic fried rice with vegetables and soy sauce',
                    ingredients: [
                        { item: 'cooked rice', amount: '4', unit: 'cups' },
                        { item: 'eggs', amount: '3', unit: 'large' },
                        { item: 'mixed vegetables', amount: '2', unit: 'cups' },
                        { item: 'soy sauce', amount: '3', unit: 'tablespoons' },
                        { item: 'sesame oil', amount: '1', unit: 'tablespoon' },
                        { item: 'garlic', amount: '3', unit: 'cloves' },
                        { item: 'green onions', amount: '4', unit: 'pieces' }
                    ],
                    instructions: [
                        'Heat oil in a large wok or skillet over high heat',
                        'Scramble eggs and remove from pan',
                        'Add garlic and vegetables, stir-fry for 2 minutes',
                        'Add rice and break up any clumps',
                        'Add soy sauce and sesame oil',
                        'Return eggs to pan and add green onions',
                        'Stir-fry for 2 more minutes and serve'
                    ],
                    cookingTime: '15 minutes',
                    servings: '4 servings',
                    calories: '320 calories per serving'
                },
                'onion': {
                    title: 'French Onion Soup',
                    description: 'Classic French onion soup with caramelized onions',
                    ingredients: [
                        { item: 'onions', amount: '4', unit: 'large' },
                        { item: 'beef broth', amount: '6', unit: 'cups' },
                        { item: 'butter', amount: '3', unit: 'tablespoons' },
                        { item: 'white wine', amount: '1/2', unit: 'cup' },
                        { item: 'baguette', amount: '1', unit: 'loaf' },
                        { item: 'gruyere cheese', amount: '2', unit: 'cups' },
                        { item: 'thyme', amount: '1', unit: 'teaspoon' }
                    ],
                    instructions: [
                        'Slice onions thinly and melt butter in large pot',
                        'Cook onions over low heat for 45 minutes until caramelized',
                        'Add wine and cook for 2 minutes',
                        'Add broth and thyme, simmer for 30 minutes',
                        'Toast baguette slices under broiler',
                        'Top soup with bread and cheese',
                        'Broil until cheese is melted and bubbly'
                    ],
                    cookingTime: '90 minutes',
                    servings: '4 servings',
                    calories: '420 calories per serving'
                },
                'carrot': {
                    title: 'Honey Glazed Carrots',
                    description: 'Sweet and tender glazed carrots with herbs',
                    ingredients: [
                        { item: 'carrots', amount: '2', unit: 'pounds' },
                        { item: 'honey', amount: '3', unit: 'tablespoons' },
                        { item: 'butter', amount: '2', unit: 'tablespoons' },
                        { item: 'thyme', amount: '1', unit: 'teaspoon' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Peel and slice carrots into uniform pieces',
                        'Melt butter in a large skillet over medium heat',
                        'Add carrots and cook for 5 minutes',
                        'Add honey and thyme, stir to coat',
                        'Cover and cook for 10 minutes until tender',
                        'Season with salt and pepper, serve hot'
                    ],
                    cookingTime: '20 minutes',
                    servings: '4 servings',
                    calories: '140 calories per serving'
                },
                'broccoli': {
                    title: 'Traditional Chinese Stir-Fried Broccoli',
                    description: 'Classic Chinese broccoli with oyster sauce and garlic',
                    ingredients: [
                        { item: 'broccoli', amount: '2', unit: 'heads' },
                        { item: 'oyster sauce', amount: '3', unit: 'tablespoons' },
                        { item: 'garlic', amount: '4', unit: 'cloves' },
                        { item: 'ginger', amount: '1', unit: 'tablespoon' },
                        { item: 'vegetable oil', amount: '2', unit: 'tablespoons' },
                        { item: 'sesame oil', amount: '1', unit: 'teaspoon' },
                        { item: 'soy sauce', amount: '1', unit: 'tablespoon' }
                    ],
                    instructions: [
                        'Cut broccoli into florets and mince garlic and ginger',
                        'Heat vegetable oil in a wok over high heat',
                        'Add garlic and ginger, stir-fry for 30 seconds',
                        'Add broccoli and stir-fry for 2 minutes',
                        'Add oyster sauce, soy sauce, and sesame oil',
                        'Continue cooking for 2 more minutes until tender',
                        'Serve hot with steamed rice'
                    ],
                    cookingTime: '10 minutes',
                    servings: '4 servings',
                    calories: '120 calories per serving'
                },
                'spinach': {
                    title: 'Traditional Greek Spanakopita',
                    description: 'Classic Greek spinach pie with feta and phyllo dough',
                    ingredients: [
                        { item: 'spinach', amount: '2', unit: 'pounds' },
                        { item: 'feta cheese', amount: '1', unit: 'pound' },
                        { item: 'phyllo dough', amount: '1', unit: 'package' },
                        { item: 'onion', amount: '1', unit: 'large' },
                        { item: 'dill', amount: '1/2', unit: 'cup' },
                        { item: 'eggs', amount: '3', unit: 'large' },
                        { item: 'butter', amount: '1/2', unit: 'cup' },
                        { item: 'olive oil', amount: '1/4', unit: 'cup' }
                    ],
                    instructions: [
                        'Wash and chop spinach, removing excess water',
                        'Saut√© chopped onion in olive oil until soft',
                        'Mix spinach with crumbled feta, dill, and beaten eggs',
                        'Layer phyllo sheets with melted butter between each',
                        'Spread spinach mixture over half the phyllo layers',
                        'Fold over remaining layers and brush with butter',
                        'Bake at 375¬∞F for 45 minutes until golden brown',
                        'Let cool for 10 minutes before cutting'
                    ],
                    cookingTime: '1 hour 15 minutes',
                    servings: '8 servings',
                    calories: '320 calories per serving'
                },
                'apple': {
                    title: 'Traditional German Apple Strudel',
                    description: 'Classic German apple strudel with flaky pastry and warm spices',
                    ingredients: [
                        { item: 'apples', amount: '6', unit: 'medium' },
                        { item: 'phyllo dough', amount: '1', unit: 'package' },
                        { item: 'breadcrumbs', amount: '1', unit: 'cup' },
                        { item: 'raisins', amount: '1/2', unit: 'cup' },
                        { item: 'cinnamon', amount: '2', unit: 'teaspoons' },
                        { item: 'sugar', amount: '1/2', unit: 'cup' },
                        { item: 'butter', amount: '1/2', unit: 'cup' },
                        { item: 'lemon', amount: '1', unit: 'whole' },
                        { item: 'vanilla', amount: '1', unit: 'teaspoon' }
                    ],
                    instructions: [
                        'Peel, core, and thinly slice apples',
                        'Mix apples with sugar, cinnamon, raisins, and lemon juice',
                        'Melt butter and brush over phyllo sheets',
                        'Sprinkle breadcrumbs over buttered phyllo',
                        'Spread apple mixture over half the phyllo',
                        'Roll up tightly, tucking in edges',
                        'Brush with remaining butter and bake at 375¬∞F for 45 minutes',
                        'Serve warm with vanilla ice cream'
                    ],
                    cookingTime: '1 hour',
                    servings: '8 servings',
                    calories: '280 calories per serving'
                },
                'banana': {
                    title: 'Banana Bread',
                    description: 'Moist and delicious banana bread with walnuts',
                    ingredients: [
                        { item: 'bananas', amount: '3', unit: 'ripe' },
                        { item: 'flour', amount: '2', unit: 'cups' },
                        { item: 'sugar', amount: '1', unit: 'cup' },
                        { item: 'eggs', amount: '2', unit: 'large' },
                        { item: 'butter', amount: '1/2', unit: 'cup' },
                        { item: 'walnuts', amount: '1/2', unit: 'cup' },
                        { item: 'vanilla', amount: '1', unit: 'teaspoon' }
                    ],
                    instructions: [
                        'Preheat oven to 350¬∞F (175¬∞C)',
                        'Mash bananas in a large bowl',
                        'Cream butter and sugar until fluffy',
                        'Add eggs and vanilla, mix well',
                        'Stir in mashed bananas',
                        'Fold in flour and chopped walnuts',
                        'Pour into greased loaf pan and bake for 60 minutes'
                    ],
                    cookingTime: '60 minutes',
                    servings: '8 servings',
                    calories: '280 calories per serving'
                },
                'mushroom': {
                    title: 'Garlic Mushroom Pasta',
                    description: 'Creamy pasta with saut√©ed mushrooms and garlic',
                    ingredients: [
                        { item: 'mushrooms', amount: '1', unit: 'pound' },
                        { item: 'linguine', amount: '1', unit: 'pound' },
                        { item: 'garlic', amount: '4', unit: 'cloves' },
                        { item: 'butter', amount: '3', unit: 'tablespoons' },
                        { item: 'parmesan cheese', amount: '1', unit: 'cup' },
                        { item: 'parsley', amount: '1/4', unit: 'cup' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Cook pasta according to package directions',
                        'Slice mushrooms and mince garlic',
                        'Melt butter in large skillet over medium heat',
                        'Add mushrooms and cook for 5 minutes',
                        'Add garlic and cook for 1 minute',
                        'Add cooked pasta and parmesan',
                        'Toss with parsley and season to taste'
                    ],
                    cookingTime: '20 minutes',
                    servings: '4 servings',
                    calories: '420 calories per serving'
                },
                'cheese': {
                    title: 'Grilled Cheese with Tomato Soup',
                    description: 'Classic grilled cheese with homemade tomato soup',
                    ingredients: [
                        { item: 'bread', amount: '8', unit: 'slices' },
                        { item: 'cheddar cheese', amount: '1', unit: 'pound' },
                        { item: 'butter', amount: '4', unit: 'tablespoons' },
                        { item: 'tomatoes', amount: '4', unit: 'large' },
                        { item: 'onion', amount: '1', unit: 'medium' },
                        { item: 'garlic', amount: '2', unit: 'cloves' },
                        { item: 'cream', amount: '1/2', unit: 'cup' }
                    ],
                    instructions: [
                        'Make soup: saut√© onion and garlic in oil',
                        'Add chopped tomatoes and simmer for 20 minutes',
                        'Blend until smooth and add cream',
                        'For sandwiches: butter bread and add cheese',
                        'Grill in skillet until golden and cheese melts',
                        'Serve hot sandwiches with warm soup'
                    ],
                    cookingTime: '30 minutes',
                    servings: '4 servings',
                    calories: '450 calories per serving'
                },
                'zucchini': {
                    title: 'Italian Zucchini Parmesan',
                    description: 'Crispy breaded zucchini with marinara and mozzarella',
                    ingredients: [
                        { item: 'zucchini', amount: '4', unit: 'medium' },
                        { item: 'breadcrumbs', amount: '2', unit: 'cups' },
                        { item: 'parmesan cheese', amount: '1', unit: 'cup' },
                        { item: 'eggs', amount: '3', unit: 'large' },
                        { item: 'marinara sauce', amount: '2', unit: 'cups' },
                        { item: 'mozzarella', amount: '1', unit: 'pound' },
                        { item: 'basil', amount: '1/4', unit: 'cup' }
                    ],
                    instructions: [
                        'Slice zucchini into 1/4-inch rounds',
                        'Dredge in flour, then beaten eggs, then breadcrumb mixture',
                        'Fry in oil until golden and crispy',
                        'Layer in baking dish with marinara and mozzarella',
                        'Bake at 375¬∞F for 20 minutes until bubbly',
                        'Garnish with fresh basil and serve'
                    ],
                    cookingTime: '35 minutes',
                    servings: '6 servings',
                    calories: '280 calories per serving'
                },
                'eggplant': {
                    title: 'Turkish Imam Bayildi',
                    description: 'Stuffed eggplant with tomatoes, onions, and herbs',
                    ingredients: [
                        { item: 'eggplant', amount: '4', unit: 'large' },
                        { item: 'onions', amount: '3', unit: 'large' },
                        { item: 'tomatoes', amount: '6', unit: 'medium' },
                        { item: 'garlic', amount: '8', unit: 'cloves' },
                        { item: 'olive oil', amount: '1/2', unit: 'cup' },
                        { item: 'parsley', amount: '1/2', unit: 'cup' },
                        { item: 'cinnamon', amount: '1', unit: 'teaspoon' }
                    ],
                    instructions: [
                        'Slice eggplant lengthwise and salt to remove bitterness',
                        'Saut√© onions and garlic in olive oil until soft',
                        'Add chopped tomatoes and cook until thickened',
                        'Stuff eggplant with onion-tomato mixture',
                        'Drizzle with olive oil and bake at 350¬∞F for 45 minutes',
                        'Serve warm or at room temperature'
                    ],
                    cookingTime: '1 hour',
                    servings: '4 servings',
                    calories: '220 calories per serving'
                },
                'cauliflower': {
                    title: 'Indian Aloo Gobi',
                    description: 'Spiced cauliflower and potatoes with aromatic spices',
                    ingredients: [
                        { item: 'cauliflower', amount: '1', unit: 'head' },
                        { item: 'potatoes', amount: '3', unit: 'medium' },
                        { item: 'onion', amount: '1', unit: 'large' },
                        { item: 'garlic', amount: '4', unit: 'cloves' },
                        { item: 'ginger', amount: '1', unit: 'tablespoon' },
                        { item: 'turmeric', amount: '1', unit: 'teaspoon' },
                        { item: 'cumin', amount: '2', unit: 'teaspoons' },
                        { item: 'coriander', amount: '1', unit: 'teaspoon' }
                    ],
                    instructions: [
                        'Cut cauliflower into florets and cube potatoes',
                        'Heat oil and add cumin seeds',
                        'Add chopped onion and cook until golden',
                        'Add ginger, garlic, and spices',
                        'Add potatoes and cook for 5 minutes',
                        'Add cauliflower and cook until tender',
                        'Garnish with fresh coriander and serve'
                    ],
                    cookingTime: '30 minutes',
                    servings: '4 servings',
                    calories: '180 calories per serving'
                },
                'quinoa': {
                    title: 'Peruvian Quinoa Bowl',
                    description: 'Nutritious quinoa with roasted vegetables and avocado',
                    ingredients: [
                        { item: 'quinoa', amount: '2', unit: 'cups' },
                        { item: 'sweet potato', amount: '2', unit: 'medium' },
                        { item: 'black beans', amount: '1', unit: 'can' },
                        { item: 'avocado', amount: '2', unit: 'ripe' },
                        { item: 'lime', amount: '2', unit: 'whole' },
                        { item: 'cilantro', amount: '1/2', unit: 'cup' },
                        { item: 'cumin', amount: '1', unit: 'teaspoon' },
                        { item: 'chili powder', amount: '1', unit: 'teaspoon' }
                    ],
                    instructions: [
                        'Cook quinoa according to package directions',
                        'Roast sweet potato cubes with spices',
                        'Warm black beans with cumin and chili powder',
                        'Mash avocado with lime juice and salt',
                        'Assemble bowls with quinoa, vegetables, and beans',
                        'Top with avocado and fresh cilantro'
                    ],
                    cookingTime: '25 minutes',
                    servings: '4 servings',
                    calories: '320 calories per serving'
                },
                'couscous': {
                    title: 'Moroccan Couscous with Vegetables',
                    description: 'Fluffy couscous with roasted vegetables and aromatic spices',
                    ingredients: [
                        { item: 'couscous', amount: '2', unit: 'cups' },
                        { item: 'carrots', amount: '4', unit: 'medium' },
                        { item: 'zucchini', amount: '2', unit: 'medium' },
                        { item: 'chickpeas', amount: '1', unit: 'can' },
                        { item: 'raisins', amount: '1/2', unit: 'cup' },
                        { item: 'cinnamon', amount: '1', unit: 'teaspoon' },
                        { item: 'cumin', amount: '1', unit: 'teaspoon' },
                        { item: 'vegetable broth', amount: '2', unit: 'cups' }
                    ],
                    instructions: [
                        'Roast vegetables with olive oil and spices',
                        'Bring broth to boil and add couscous',
                        'Remove from heat and let stand for 5 minutes',
                        'Fluff couscous with a fork',
                        'Mix in roasted vegetables and chickpeas',
                        'Add raisins and serve warm'
                    ],
                    cookingTime: '20 minutes',
                    servings: '4 servings',
                    calories: '280 calories per serving'
                },
                'lentils': {
                    title: 'Indian Dal Tadka',
                    description: 'Spiced red lentils with aromatic tempering',
                    ingredients: [
                        { item: 'red lentils', amount: '2', unit: 'cups' },
                        { item: 'onion', amount: '1', unit: 'large' },
                        { item: 'garlic', amount: '4', unit: 'cloves' },
                        { item: 'ginger', amount: '1', unit: 'tablespoon' },
                        { item: 'turmeric', amount: '1', unit: 'teaspoon' },
                        { item: 'cumin seeds', amount: '1', unit: 'teaspoon' },
                        { item: 'mustard seeds', amount: '1', unit: 'teaspoon' },
                        { item: 'curry leaves', amount: '10', unit: 'leaves' }
                    ],
                    instructions: [
                        'Rinse lentils and cook with turmeric and salt',
                        'Saut√© onion, garlic, and ginger until soft',
                        'Add cooked lentils and simmer until thick',
                        'Heat oil and add mustard and cumin seeds',
                        'Add curry leaves and pour over lentils',
                        'Serve hot with rice or bread'
                    ],
                    cookingTime: '30 minutes',
                    servings: '4 servings',
                    calories: '220 calories per serving'
                },
                'chickpeas': {
                    title: 'Lebanese Hummus',
                    description: 'Creamy chickpea dip with tahini and lemon',
                    ingredients: [
                        { item: 'chickpeas', amount: '2', unit: 'cups' },
                        { item: 'tahini', amount: '1/3', unit: 'cup' },
                        { item: 'lemon', amount: '2', unit: 'whole' },
                        { item: 'garlic', amount: '3', unit: 'cloves' },
                        { item: 'olive oil', amount: '1/4', unit: 'cup' },
                        { item: 'cumin', amount: '1', unit: 'teaspoon' },
                        { item: 'paprika', amount: '1', unit: 'teaspoon' },
                        { item: 'parsley', amount: '2', unit: 'tablespoons' }
                    ],
                    instructions: [
                        'Drain and rinse chickpeas',
                        'Blend chickpeas with tahini, lemon juice, and garlic',
                        'Add olive oil and blend until smooth',
                        'Season with salt, cumin, and paprika',
                        'Garnish with olive oil and parsley',
                        'Serve with pita bread and vegetables'
                    ],
                    cookingTime: '10 minutes',
                    servings: '6 servings',
                    calories: '180 calories per serving'
                },
                'sweet potato': {
                    title: 'Korean Sweet Potato Fries',
                    description: 'Crispy sweet potato fries with gochujang dipping sauce',
                    ingredients: [
                        { item: 'sweet potatoes', amount: '4', unit: 'large' },
                        { item: 'cornstarch', amount: '1/4', unit: 'cup' },
                        { item: 'gochujang', amount: '2', unit: 'tablespoons' },
                        { item: 'honey', amount: '1', unit: 'tablespoon' },
                        { item: 'sesame oil', amount: '1', unit: 'teaspoon' },
                        { item: 'garlic', amount: '2', unit: 'cloves' },
                        { item: 'vegetable oil', amount: '1/2', unit: 'cup' }
                    ],
                    instructions: [
                        'Cut sweet potatoes into fry shapes',
                        'Soak in cold water for 30 minutes',
                        'Drain and toss with cornstarch',
                        'Deep-fry in batches until crispy',
                        'Mix gochujang, honey, sesame oil, and garlic for sauce',
                        'Serve hot fries with dipping sauce'
                    ],
                    cookingTime: '45 minutes',
                    servings: '4 servings',
                    calories: '280 calories per serving'
                },
                'asparagus': {
                    title: 'French Asparagus with Hollandaise',
                    description: 'Tender asparagus with classic French hollandaise sauce',
                    ingredients: [
                        { item: 'asparagus', amount: '2', unit: 'pounds' },
                        { item: 'butter', amount: '1/2', unit: 'cup' },
                        { item: 'egg yolks', amount: '3', unit: 'large' },
                        { item: 'lemon', amount: '1', unit: 'whole' },
                        { item: 'white wine vinegar', amount: '1', unit: 'tablespoon' },
                        { item: 'tarragon', amount: '1', unit: 'tablespoon' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Trim asparagus and blanch in salted water',
                        'Melt butter in a double boiler',
                        'Whisk egg yolks with vinegar and lemon juice',
                        'Slowly add melted butter while whisking',
                        'Add tarragon and season to taste',
                        'Serve asparagus with warm hollandaise'
                    ],
                    cookingTime: '20 minutes',
                    servings: '4 servings',
                    calories: '220 calories per serving'
                },
                'mango': {
                    title: 'Thai Mango Sticky Rice',
                    description: 'Sweet sticky rice with fresh mango and coconut sauce',
                    ingredients: [
                        { item: 'sticky rice', amount: '2', unit: 'cups' },
                        { item: 'mango', amount: '4', unit: 'ripe' },
                        { item: 'coconut milk', amount: '1', unit: 'can' },
                        { item: 'palm sugar', amount: '1/2', unit: 'cup' },
                        { item: 'sesame seeds', amount: '2', unit: 'tablespoons' },
                        { item: 'salt', amount: '1/4', unit: 'teaspoon' }
                    ],
                    instructions: [
                        'Soak sticky rice in water for 4 hours',
                        'Steam rice for 20 minutes until tender',
                        'Heat coconut milk with palm sugar and salt',
                        'Pour warm coconut sauce over rice',
                        'Slice mango and arrange on top',
                        'Sprinkle with sesame seeds and serve'
                    ],
                    cookingTime: '30 minutes',
                    servings: '4 servings',
                    calories: '320 calories per serving'
                },
                'strawberry': {
                    title: 'French Strawberry Tart',
                    description: 'Classic French pastry with fresh strawberries and cream',
                    ingredients: [
                        { item: 'strawberries', amount: '2', unit: 'pints' },
                        { item: 'pie crust', amount: '1', unit: 'pre-made' },
                        { item: 'cream cheese', amount: '8', unit: 'ounces' },
                        { item: 'heavy cream', amount: '1/2', unit: 'cup' },
                        { item: 'sugar', amount: '1/3', unit: 'cup' },
                        { item: 'vanilla', amount: '1', unit: 'teaspoon' },
                        { item: 'apricot jam', amount: '1/4', unit: 'cup' }
                    ],
                    instructions: [
                        'Bake pie crust until golden',
                        'Beat cream cheese with sugar and vanilla',
                        'Whip cream and fold into cream cheese mixture',
                        'Spread filling in cooled crust',
                        'Arrange strawberries on top',
                        'Glaze with warm apricot jam'
                    ],
                    cookingTime: '1 hour',
                    servings: '8 servings',
                    calories: '280 calories per serving'
                }
            };

            // Try to find a matching recipe with more specific matching
            for (const ingredient of ingredients) {
                const lowerIngredient = ingredient.toLowerCase();
                
                // Check for exact matches first
                if (recipes[lowerIngredient]) {
                    let recipe = recipes[lowerIngredient];
                    
                    // Apply dietary restrictions
                    if (restrictions && restrictions.length > 0) {
                        recipe = applyDietaryRestrictions(recipe, restrictions);
                    }
                    
                    return recipe;
                }
                
                // Check for partial matches with more specific logic
                for (const [key, recipe] of Object.entries(recipes)) {
                    if (lowerIngredient.includes(key) && key.length > 2) {
                        return recipe;
                    }
                }
                
                // Check for word-based matches (for complex ingredients)
                const ingredientWords = lowerIngredient.split(' ');
                for (const word of ingredientWords) {
                    if (word.length > 2 && recipes[word]) {
                        return recipes[word];
                    }
                }
            }
            
            // If no specific recipe found, create a multi-ingredient recipe
            if (ingredients.length > 1) {
                return createMultiIngredientRecipe(ingredients, restrictions);
            }

            // Create a simple, universal recipe for any ingredient
            const mainIngredient = ingredients[0];
            const recipeTitle = `${mainIngredient} with Garlic and Herbs`;
            const description = `A delicious and simple way to prepare ${mainIngredient}`;
            const additionalIngredients = [
                { item: mainIngredient, amount: '2', unit: 'cups' },
                { item: 'olive oil', amount: '3', unit: 'tablespoons' },
                { item: 'garlic', amount: '4', unit: 'cloves' },
                { item: 'fresh herbs', amount: '2', unit: 'tablespoons' },
                { item: 'lemon', amount: '1', unit: 'whole' },
                { item: 'butter', amount: '2', unit: 'tablespoons' },
                { item: 'salt and pepper', amount: 'to taste', unit: '' }
            ];
            const instructions = [
                'Heat olive oil and butter in large skillet over medium heat',
                'Add minced garlic and cook for 1 minute until fragrant',
                `Add ${mainIngredient} and cook for 3-4 minutes`,
                'Add fresh herbs and stir to combine',
                'Squeeze lemon juice over and season with salt and pepper',
                'Cook for 2 more minutes until flavors meld',
                'Serve hot as a side dish or over rice'
            ];
            const calories = '180 calories per serving';
            
            return {
                title: recipeTitle,
                description: description,
                ingredients: additionalIngredients,
                instructions: instructions,
                cookingTime: '20 minutes',
                servings: '4 servings',
                calories: calories
            };
        }

        function displayRecipe(recipe) {
            document.getElementById('recipe-title').textContent = recipe.title;
            document.getElementById('recipe-description').textContent = recipe.description;
            
            // Display ingredients (scale for premium users)
            const ingredientsList = document.getElementById('recipe-ingredients');
            ingredientsList.innerHTML = '';
            recipe.ingredients.forEach(ingredient => {
                const li = document.createElement('li');
                li.className = 'flex items-center';
                let amount = ingredient.amount;
                let unit = ingredient.unit;
                
                // Scale ingredients for premium users
                if (isPremium && servings !== 4) {
                    const originalAmount = parseFloat(amount);
                    const scaleFactor = servings / 4;
                    amount = (originalAmount * scaleFactor).toFixed(1);
                    if (amount.endsWith('.0')) amount = amount.slice(0, -2);
                }
                
                li.innerHTML = `
                    <span class="ingredient-tag mr-2">${amount} ${unit}</span>
                    <span class="text-gray-700">${ingredient.item}</span>
                `;
                ingredientsList.appendChild(li);
            });

            // Display instructions
            const instructionsList = document.getElementById('recipe-instructions');
            instructionsList.innerHTML = '';
            recipe.instructions.forEach((instruction, index) => {
                const li = document.createElement('li');
                li.className = 'flex items-start gap-3';
                li.innerHTML = `
                    <div class="step-number">${index + 1}</div>
                    <span class="text-gray-700">${instruction}</span>
                `;
                instructionsList.appendChild(li);
            });

            // Display cooking info
            document.getElementById('cooking-time').textContent = recipe.cookingTime;
            document.getElementById('servings').textContent = isPremium ? `${servings} servings` : recipe.servings;
            document.getElementById('calories').textContent = recipe.calories;

            // Show the recipe
            document.getElementById('recipe-display').classList.remove('hidden');
            document.getElementById('recipe-display').scrollIntoView({ behavior: 'smooth' });
        }

        // Premium Functions
        function showPremiumModal() {
            const modal = document.getElementById('premium-modal');
            const premiumStatus = document.getElementById('premium-status');
            const premiumPlans = document.querySelector('.grid.md\\:grid-cols-2');
            
            modal.classList.remove('hidden');
            
            // Show different content based on premium status
            if (isPremium) {
                premiumStatus.classList.remove('hidden');
                premiumPlans.classList.add('hidden');
            } else {
                premiumStatus.classList.add('hidden');
                premiumPlans.classList.remove('hidden');
            }
        }

        function hidePremiumModal() {
            document.getElementById('premium-modal').classList.add('hidden');
            document.getElementById('payment-form').classList.add('hidden');
        }

        function cancelPremium() {
            if (confirm('Are you sure you want to cancel your premium subscription? You will lose access to all premium features.')) {
                // Remove premium status
                isPremium = false;
                localStorage.removeItem('isPremium');
                
                // Hide premium modal
                hidePremiumModal();
                
                // Reload the page to show non-premium version
                location.reload();
                
                alert('Premium subscription cancelled. You are now on the free plan.');
            }
        }

        function resetApp() {
            if (confirm('Are you sure you want to reset the app? This will clear all data including premium status, saved recipes, and history.')) {
                // Clear all localStorage data
                localStorage.clear();
                
                // Reset variables
                isPremium = false;
                ingredientCount = 1;
                servings = 4;
                
                // Reload the page
                location.reload();
                
                alert('App reset successfully! All data has been cleared.');
            }
        }

        function viewFullRecipeByIndex(index) {
            const savedRecipes = JSON.parse(localStorage.getItem('savedRecipes') || '[]');
            // Sort recipes by save date (newest first) to match the display order
            savedRecipes.sort((a, b) => new Date(b.savedAt) - new Date(a.savedAt));
            const recipe = savedRecipes[index];
            
            if (!recipe) {
                alert('Recipe not found!');
                return;
            }
            
            // Display the full recipe
            displayRecipe(recipe);
            
            // Go back to main page to show the recipe
            showMainPage();
        }

        function addToShoppingListByIndex(index) {
            const savedRecipes = JSON.parse(localStorage.getItem('savedRecipes') || '[]');
            // Sort recipes by save date (newest first) to match the display order
            savedRecipes.sort((a, b) => new Date(b.savedAt) - new Date(a.savedAt));
            const recipe = savedRecipes[index];
            
            if (!recipe) {
                alert('Recipe not found!');
                return;
            }
            
            const shoppingList = JSON.parse(localStorage.getItem('shoppingList') || '[]');
            
            // Add all ingredients from the recipe
            recipe.ingredients.forEach(ingredient => {
                // Check if ingredient already exists
                const existingIndex = shoppingList.findIndex(item => 
                    item.item.toLowerCase() === ingredient.item.toLowerCase()
                );
                
                if (existingIndex !== -1) {
                    // Update quantity if ingredient exists
                    const existing = shoppingList[existingIndex];
                    const existingAmount = parseFloat(existing.amount);
                    const newAmount = parseFloat(ingredient.amount);
                    shoppingList[existingIndex].amount = (existingAmount + newAmount).toString();
                } else {
                    // Add new ingredient
                    shoppingList.push({
                        item: ingredient.item,
                        amount: ingredient.amount,
                        unit: ingredient.unit,
                        fromRecipe: recipe.title
                    });
                }
            });
            
            localStorage.setItem('shoppingList', JSON.stringify(shoppingList));
            alert(`Added ${recipe.ingredients.length} ingredients from "${recipe.title}" to your shopping list!`);
        }

        function deleteSavedRecipeByIndex(index) {
            const savedRecipes = JSON.parse(localStorage.getItem('savedRecipes') || '[]');
            // Sort recipes by save date (newest first) to match the display order
            savedRecipes.sort((a, b) => new Date(b.savedAt) - new Date(a.savedAt));
            const recipe = savedRecipes[index];
            
            if (!recipe) {
                alert('Recipe not found!');
                return;
            }
            
            if (confirm(`Are you sure you want to delete "${recipe.title}" from your saved recipes?`)) {
                // Find the original index in the unsorted array
                const originalRecipes = JSON.parse(localStorage.getItem('savedRecipes') || '[]');
                const originalIndex = originalRecipes.findIndex(r => r.title === recipe.title);
                
                if (originalIndex !== -1) {
                    originalRecipes.splice(originalIndex, 1);
                    localStorage.setItem('savedRecipes', JSON.stringify(originalRecipes));
                    
                    // Refresh the saved recipes page
                    showSavedRecipesPage();
                    
                    alert('Recipe deleted successfully!');
                }
            }
        }

        function viewFullRecipeByIndex(index) {
            const savedRecipes = JSON.parse(localStorage.getItem('savedRecipes') || '[]');
            // Sort recipes by save date (newest first) to match the display order
            savedRecipes.sort((a, b) => new Date(b.savedAt) - new Date(a.savedAt));
            const recipe = savedRecipes[index];
            
            if (!recipe) {
                alert('Recipe not found!');
                return;
            }
            
            // Display the full recipe
            displayRecipe(recipe);
            
            // Go back to main page to show the recipe
            showMainPage();
        }

        function addToShoppingListByIndex(index) {
            const savedRecipes = JSON.parse(localStorage.getItem('savedRecipes') || '[]');
            // Sort recipes by save date (newest first) to match the display order
            savedRecipes.sort((a, b) => new Date(b.savedAt) - new Date(a.savedAt));
            const recipe = savedRecipes[index];
            
            if (!recipe) {
                alert('Recipe not found!');
                return;
            }
            
            const shoppingList = JSON.parse(localStorage.getItem('shoppingList') || '[]');
            
            // Add all ingredients from the recipe
            recipe.ingredients.forEach(ingredient => {
                // Check if ingredient already exists
                const existingIndex = shoppingList.findIndex(item => 
                    item.item.toLowerCase() === ingredient.item.toLowerCase()
                );
                
                if (existingIndex !== -1) {
                    // Update quantity if ingredient exists
                    const existing = shoppingList[existingIndex];
                    const existingAmount = parseFloat(existing.amount);
                    const newAmount = parseFloat(ingredient.amount);
                    shoppingList[existingIndex].amount = (existingAmount + newAmount).toString();
                } else {
                    // Add new ingredient
                    shoppingList.push({
                        item: ingredient.item,
                        amount: ingredient.amount,
                        unit: ingredient.unit,
                        fromRecipe: recipe.title
                    });
                }
            });
            
            localStorage.setItem('shoppingList', JSON.stringify(shoppingList));
            alert(`Added ${recipe.ingredients.length} ingredients from "${recipe.title}" to your shopping list!`);
        }

        function selectPlan(plan) {
            selectedPlan = plan;
            const price = plan === 'monthly' ? '$9.99' : '$79.99';
            document.getElementById('plan-price').textContent = price;
            document.getElementById('payment-form').classList.remove('hidden');
        }

        function processPayment() {
            const cardNumber = document.getElementById('card-number').value;
            const cardExpiry = document.getElementById('card-expiry').value;
            const cardCvv = document.getElementById('card-cvv').value;
            const cardName = document.getElementById('card-name').value;
            const email = document.getElementById('customer-email').value;

            if (!cardNumber || !cardExpiry || !cardCvv || !cardName || !email) {
                alert('Please fill in all payment fields including email');
                return;
            }

            // Show loading state
            const payButton = document.querySelector('button[onclick="processPayment()"]');
            const originalText = payButton.textContent;
            payButton.textContent = 'Processing...';
            payButton.disabled = true;

            // Simulate payment processing (in real app, this would use Stripe)
            setTimeout(() => {
                // Payment successful
                isPremium = true;
                localStorage.setItem('isPremium', 'true');
                
                hidePremiumModal();
                document.getElementById('premium-banner').classList.add('hidden');
                addPremiumFeatures();
                
                alert('Payment successful! Welcome to Premium!');
                
                payButton.textContent = originalText;
                payButton.disabled = false;
            }, 2000);
        }

        function addPremiumFeatures() {
            const form = document.querySelector('.card.p-6.mb-6');
            
            // Add servings selector
            const servingsDiv = document.createElement('div');
            servingsDiv.className = 'mb-4';
            servingsDiv.innerHTML = `
                <label class="block text-gray-700 font-semibold mb-2">Servings (Premium):</label>
                <select id="servings-select" onchange="updateServings(this.value)" class="input-field">
                    <option value="2">2 servings</option>
                    <option value="4" selected>4 servings</option>
                    <option value="6">6 servings</option>
                    <option value="8">8 servings</option>
                    <option value="10">10 servings</option>
                    <option value="12">12 servings</option>
                </select>
            `;
            
            // Add cooking time preference
            const timeDiv = document.createElement('div');
            timeDiv.className = 'mb-4';
            timeDiv.innerHTML = `
                <label class="block text-gray-700 font-semibold mb-2">Cooking Time (Premium):</label>
                <select id="time-select" onchange="updateCookingTime(this.value)" class="input-field">
                    <option value="any">Any time</option>
                    <option value="quick">Quick (15 min or less)</option>
                    <option value="medium">Medium (15-30 min)</option>
                    <option value="slow">Slow (30+ min)</option>
                </select>
            `;
            
            // Add cuisine preference
            const cuisineDiv = document.createElement('div');
            cuisineDiv.className = 'mb-4';
            cuisineDiv.innerHTML = `
                <label class="block text-gray-700 font-semibold mb-2">Cuisine Style (Premium):</label>
                <select id="cuisine-select" onchange="updateCuisine(this.value)" class="input-field">
                    <option value="any">Any cuisine</option>
                    <option value="italian">Italian</option>
                    <option value="asian">Asian</option>
                    <option value="mexican">Mexican</option>
                    <option value="mediterranean">Mediterranean</option>
                    <option value="indian">Indian</option>
                    <option value="american">American</option>
                </select>
            `;
            
            // Add difficulty level
            const difficultyDiv = document.createElement('div');
            difficultyDiv.className = 'mb-4';
            difficultyDiv.innerHTML = `
                <label class="block text-gray-700 font-semibold mb-2">Difficulty Level (Premium):</label>
                <select id="difficulty-select" onchange="updateDifficulty(this.value)" class="input-field">
                    <option value="any">Any difficulty</option>
                    <option value="easy">Easy (Beginner)</option>
                    <option value="medium">Medium (Intermediate)</option>
                    <option value="hard">Hard (Advanced)</option>
                </select>
            `;
            
            // Add meal planning section
            const mealPlanDiv = document.createElement('div');
            mealPlanDiv.className = 'mb-4';
            mealPlanDiv.innerHTML = `
                <label class="block text-gray-700 font-semibold mb-2">Meal Planning (Premium):</label>
                <div class="flex gap-2">
                    <button onclick="addToMealPlan('breakfast')" class="btn-primary text-sm px-3 py-1">Breakfast</button>
                    <button onclick="addToMealPlan('lunch')" class="btn-primary text-sm px-3 py-1">Lunch</button>
                    <button onclick="addToMealPlan('dinner')" class="btn-primary text-sm px-3 py-1">Dinner</button>
                    <button onclick="addToMealPlan('snack')" class="btn-primary text-sm px-3 py-1">Snack</button>
                </div>
            `;
            
            // Add recipe collections
            const collectionsDiv = document.createElement('div');
            collectionsDiv.className = 'mb-4';
            collectionsDiv.innerHTML = `
                <label class="block text-gray-700 font-semibold mb-2">Recipe Collections (Premium):</label>
                <div class="flex gap-2">
                    <button onclick="navigateToPage('saved-recipes')" class="btn-primary text-sm px-3 py-1">Saved Recipes</button>
                    <button onclick="navigateToPage('shopping-list')" class="btn-primary text-sm px-3 py-1">Shopping List</button>
                    <button onclick="navigateToPage('meal-plan')" class="btn-primary text-sm px-3 py-1">Meal Plan</button>
                </div>
            `;
            
            // Add cooking tips and substitutions
            const tipsDiv = document.createElement('div');
            tipsDiv.className = 'mb-4';
            tipsDiv.innerHTML = `
                <label class="block text-gray-700 font-semibold mb-2">Smart Features (Premium):</label>
                <div class="flex gap-2">
                    <button onclick="navigateToPage('cooking-tips')" class="btn-primary text-sm px-3 py-1">Cooking Tips</button>
                    <button onclick="navigateToPage('substitutions')" class="btn-primary text-sm px-3 py-1">Substitutions</button>
                    <button onclick="navigateToPage('wine-pairing')" class="btn-primary text-sm px-3 py-1">Wine Pairing</button>
                </div>
            `;
            
            // Add recipe rating and reviews
            const ratingDiv = document.createElement('div');
            ratingDiv.className = 'mb-4';
            ratingDiv.innerHTML = `
                <label class="block text-gray-700 font-semibold mb-2">Recipe Rating (Premium):</label>
                <div class="flex gap-2">
                    <button onclick="rateRecipe(5)" class="text-2xl">‚òÖ</button>
                    <button onclick="rateRecipe(4)" class="text-2xl">‚òÖ</button>
                    <button onclick="rateRecipe(3)" class="text-2xl">‚òÖ</button>
                    <button onclick="rateRecipe(2)" class="text-2xl">‚òÖ</button>
                    <button onclick="rateRecipe(1)" class="text-2xl">‚òÖ</button>
                </div>
            `;
            
            // Add cooking timer and modes
            const timerDiv = document.createElement('div');
            timerDiv.className = 'mb-4';
            timerDiv.innerHTML = `
                <label class="block text-gray-700 font-semibold mb-2">Cooking Timer (Premium):</label>
                <div class="flex gap-2">
                    <button onclick="startTimer(5)" class="btn-primary text-sm px-3 py-1">5 min</button>
                    <button onclick="startTimer(10)" class="btn-primary text-sm px-3 py-1">10 min</button>
                    <button onclick="startTimer(15)" class="btn-primary text-sm px-3 py-1">15 min</button>
                    <button onclick="startTimer(30)" class="btn-primary text-sm px-3 py-1">30 min</button>
                    <button onclick="customTimer()" class="btn-primary text-sm px-3 py-1">Custom</button>
                </div>
            `;
            
            // Add recipe history and favorites
            const historyDiv = document.createElement('div');
            historyDiv.className = 'mb-4';
            historyDiv.innerHTML = `
                <label class="block text-gray-700 font-semibold mb-2">Recipe History (Premium):</label>
                <div class="flex gap-2">
                    <button onclick="navigateToPage('recipe-history')" class="btn-primary text-sm px-3 py-1">History</button>
                    <button onclick="navigateToPage('favorites')" class="btn-primary text-sm px-3 py-1">Favorites</button>
                    <button onclick="navigateToPage('timer')" class="btn-primary text-sm px-3 py-1">Timer</button>
                </div>
            `;
            
            // Insert after dietary restrictions
            const dietaryDiv = form.querySelector('.mb-4:last-of-type');
            dietaryDiv.parentNode.insertBefore(servingsDiv, dietaryDiv.nextSibling);
            dietaryDiv.parentNode.insertBefore(timeDiv, servingsDiv.nextSibling);
            dietaryDiv.parentNode.insertBefore(cuisineDiv, timeDiv.nextSibling);
            dietaryDiv.parentNode.insertBefore(difficultyDiv, cuisineDiv.nextSibling);
            dietaryDiv.parentNode.insertBefore(mealPlanDiv, difficultyDiv.nextSibling);
            dietaryDiv.parentNode.insertBefore(collectionsDiv, mealPlanDiv.nextSibling);
            dietaryDiv.parentNode.insertBefore(tipsDiv, collectionsDiv.nextSibling);
            dietaryDiv.parentNode.insertBefore(ratingDiv, tipsDiv.nextSibling);
            dietaryDiv.parentNode.insertBefore(timerDiv, ratingDiv.nextSibling);
            dietaryDiv.parentNode.insertBefore(historyDiv, timerDiv.nextSibling);
        }

        // Timer functions
        let activeTimer = null;
        
        function startTimer(minutes) {
            if (activeTimer) {
                clearInterval(activeTimer);
            }
            
            let timeLeft = minutes * 60;
            const timerDisplay = document.createElement('div');
            timerDisplay.id = 'timer-display';
            timerDisplay.className = 'fixed top-4 right-4 bg-pink-500 text-white p-4 rounded-lg shadow-lg z-50';
            timerDisplay.innerHTML = `
                <div class="text-center">
                    <div class="text-2xl font-bold">‚è∞ Cooking Timer</div>
                    <div id="timer-time" class="text-3xl font-bold">${Math.floor(timeLeft/60)}:${(timeLeft%60).toString().padStart(2,'0')}</div>
                    <button onclick="stopTimer()" class="btn-primary mt-2 text-sm">Stop Timer</button>
                </div>
            `;
            
            document.body.appendChild(timerDisplay);
            
            activeTimer = setInterval(() => {
                timeLeft--;
                const minutes = Math.floor(timeLeft/60);
                const seconds = timeLeft%60;
                document.getElementById('timer-time').textContent = `${minutes}:${seconds.toString().padStart(2,'0')}`;
                
                if (timeLeft <= 0) {
                    stopTimer();
                    alert('‚è∞ Timer finished! Your food is ready!');
                }
            }, 1000);
        }
        
        function stopTimer() {
            if (activeTimer) {
                clearInterval(activeTimer);
                activeTimer = null;
            }
            const timerDisplay = document.getElementById('timer-display');
            if (timerDisplay) {
                timerDisplay.remove();
            }
        }
        
        function customTimer() {
            const minutes = prompt('Enter timer duration in minutes:');
            if (minutes && !isNaN(minutes)) {
                startTimer(parseInt(minutes));
            }
        }

        // Recipe history functions
        function viewRecipeHistory() {
            const history = JSON.parse(localStorage.getItem('recipeHistory') || '[]');
            if (history.length === 0) {
                alert('No recipe history yet! Generate recipes to see them here.');
                return;
            }
            
            let historyText = 'üìö Recipe History:\n\n';
            history.slice(-10).reverse().forEach((recipe, index) => {
                const date = new Date(recipe.date).toLocaleDateString();
                historyText += `${index + 1}. ${recipe.title} (${date})\n`;
            });
            
            alert(historyText);
        }
        
        function viewFavorites() {
            const favorites = JSON.parse(localStorage.getItem('recipeFavorites') || '[]');
            if (favorites.length === 0) {
                alert('No favorite recipes yet! Rate recipes 5 stars to add them to favorites.');
                return;
            }
            
            let favoritesText = '‚≠ê Favorite Recipes:\n\n';
            favorites.forEach((recipe, index) => {
                favoritesText += `${index + 1}. ${recipe.title} (${recipe.rating}‚≠ê)\n`;
            });
            
            alert(favoritesText);
        }
        
        function clearHistory() {
            if (confirm('Are you sure you want to clear all recipe history?')) {
                localStorage.removeItem('recipeHistory');
                localStorage.removeItem('recipeFavorites');
                alert('Recipe history cleared!');
            }
        }

        // Navigation system
        function navigateToPage(page) {
            const mainContent = document.querySelector('.container');
            
            switch(page) {
                case 'cooking-tips':
                    showCookingTipsPage();
                    break;
                case 'substitutions':
                    showSubstitutionsPage();
                    break;
                case 'wine-pairing':
                    showWinePairingPage();
                    break;
                case 'saved-recipes':
                    showSavedRecipesPage();
                    break;
                case 'shopping-list':
                    showShoppingListPage();
                    break;
                case 'meal-plan':
                    showMealPlanPage();
                    break;
                case 'recipe-history':
                    showRecipeHistoryPage();
                    break;
                case 'favorites':
                    showFavoritesPage();
                    break;
                case 'timer':
                    showTimerPage();
                    break;
            }
        }

        function showCookingTipsPage() {
            const mainContent = document.querySelector('.container');
            mainContent.innerHTML = `
                <div class="text-center mb-8">
                    <button onclick="goBack()" class="btn-primary mb-4">‚Üê Back to Recipe Generator</button>
                    <h1 class="text-4xl font-bold text-gray-800 mb-2">üí° Cooking Tips</h1>
                    <p class="text-gray-600">Professional cooking tips to improve your skills!</p>
                </div>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="card p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">üî™ Knife Skills</h3>
                        <ul class="space-y-2 text-gray-700">
                            <li>‚Ä¢ Always sharpen your knives before cooking</li>
                            <li>‚Ä¢ Use a claw grip to protect your fingers</li>
                            <li>‚Ä¢ Keep your knife at a 20-degree angle</li>
                            <li>‚Ä¢ Use a cutting board with a damp towel underneath</li>
                        </ul>
                    </div>
                    
                    <div class="card p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">üå°Ô∏è Temperature Control</h3>
                        <ul class="space-y-2 text-gray-700">
                            <li>‚Ä¢ Let meat rest for 5-10 minutes after cooking</li>
                            <li>‚Ä¢ Use a meat thermometer for perfect doneness</li>
                            <li>‚Ä¢ Preheat your pan before adding ingredients</li>
                            <li>‚Ä¢ Test oil temperature with a drop of water</li>
                        </ul>
                    </div>
                    
                    <div class="card p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">üßÇ Seasoning</h3>
                        <ul class="space-y-2 text-gray-700">
                            <li>‚Ä¢ Season in layers throughout cooking</li>
                            <li>‚Ä¢ Taste as you cook and adjust gradually</li>
                            <li>‚Ä¢ Salt draws out moisture, so add early</li>
                            <li>‚Ä¢ Fresh herbs go in at the end</li>
                        </ul>
                    </div>
                    
                    <div class="card p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">ü•ò Equipment</h3>
                        <ul class="space-y-2 text-gray-700">
                            <li>‚Ä¢ Use wooden spoons for non-stick pans</li>
                            <li>‚Ä¢ Keep a bowl of water nearby for testing</li>
                            <li>‚Ä¢ Use the right pan size for your ingredients</li>
                            <li>‚Ä¢ Clean as you go to stay organized</li>
                        </ul>
                    </div>
                </div>
            `;
        }

        function showSubstitutionsPage() {
            currentPage = 'substitutions';
            const mainContent = document.querySelector('.container');
            mainContent.innerHTML = `
                <div class="text-center mb-8">
                    <button onclick="goBack()" class="btn-primary mb-4">‚Üê Back to Recipe Generator</button>
                    <h1 class="text-4xl font-bold text-gray-800 mb-2">Ingredient Substitutions</h1>
                    <p class="text-gray-600">Common ingredient replacements for dietary needs!</p>
                </div>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="card p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Dairy Substitutions</h3>
                        <ul class="space-y-2 text-gray-700">
                            <li><strong>Butter:</strong> Olive oil, coconut oil, applesauce</li>
                            <li><strong>Milk:</strong> Almond, soy, oat, or coconut milk</li>
                            <li><strong>Cream:</strong> Coconut milk, cashew cream</li>
                            <li><strong>Cheese:</strong> Nutritional yeast, vegan cheese</li>
                        </ul>
                    </div>
                    
                    <div class="card p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Egg Substitutions</h3>
                        <ul class="space-y-2 text-gray-700">
                            <li><strong>1 Egg:</strong> 1 tbsp flax + 3 tbsp water</li>
                            <li><strong>1 Egg:</strong> 1/4 cup mashed banana</li>
                            <li><strong>1 Egg:</strong> 1/4 cup applesauce</li>
                            <li><strong>1 Egg:</strong> Commercial egg replacer</li>
                        </ul>
                    </div>
                    
                    <div class="card p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Flour Substitutions</h3>
                        <ul class="space-y-2 text-gray-700">
                            <li><strong>All-purpose:</strong> Almond flour, coconut flour</li>
                            <li><strong>Gluten-free:</strong> Rice flour, tapioca starch</li>
                            <li><strong>Whole wheat:</strong> Spelt flour, oat flour</li>
                            <li><strong>Bread flour:</strong> All-purpose + vital wheat gluten</li>
                        </ul>
                    </div>
                    
                    <div class="card p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Sweetener Substitutions</h3>
                        <ul class="space-y-2 text-gray-700">
                            <li><strong>Sugar:</strong> Honey, maple syrup, stevia</li>
                            <li><strong>Brown sugar:</strong> White sugar + molasses</li>
                            <li><strong>Powdered sugar:</strong> Blend granulated sugar</li>
                            <li><strong>Corn syrup:</strong> Honey, agave nectar</li>
                        </ul>
                    </div>
                </div>
            `;
        }

        let currentPage = 'main';
        let previousPage = 'main';

        function goBack() {
            if (currentPage === 'main') {
                // If we're on the main page, reload to get back to premium state
                location.reload();
            } else {
                // If we're on a premium page, go back to the main page with premium features
                showMainPage();
            }
        }

        function showMainPage() {
            currentPage = 'main';
            // Instead of reloading, restore the premium state
            if (isPremium) {
                // Recreate the main page with premium features
                const mainContent = document.querySelector('.container');
                mainContent.innerHTML = `
                    <div class="text-center mb-8">
                        <h1 class="text-4xl font-bold text-gray-800 mb-2">Recipe Generator</h1>
                        <p class="text-gray-600">Enter your ingredients and get delicious recipes!</p>
                        
                        <!-- Premium Banner -->
                        <div id="premium-banner" class="card p-4 mt-4 bg-gradient-to-r from-yellow-100 to-orange-100 border-2 border-yellow-200 hidden">
                            <div class="flex items-center justify-center gap-4">
                                <div>
                                    <h3 class="text-lg font-bold text-gray-800">Premium Active</h3>
                                    <p class="text-sm text-gray-600">You have access to all premium features!</p>
                                </div>
                                <div class="flex gap-2">
                                    <button onclick="showPremiumModal()" class="btn-primary px-4 py-2 text-sm">
                                        Manage Subscription
                                    </button>
                                    <button onclick="cancelPremium()" class="btn-primary bg-red-500 hover:bg-red-600 px-4 py-2 text-sm">
                                        Cancel Premium
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Input Form -->
                    <div class="card p-6 mb-6">
                        <div class="mb-4">
                            <label class="block text-gray-700 font-semibold mb-2">Ingredients:</label>
                            <div id="ingredients-container">
                                <div class="flex gap-2 mb-2">
                                    <input type="text" class="input-field flex-1" placeholder="Enter an ingredient..." id="ingredient-0">
                                    <button onclick="addIngredient()" class="btn-primary">+</button>
                                </div>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label class="block text-gray-700 font-semibold mb-2">Dietary Restrictions:</label>
                            <div class="flex flex-wrap gap-2">
                                <label class="flex items-center">
                                    <input type="checkbox" class="mr-2" value="vegetarian"> Vegetarian
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="mr-2" value="vegan"> Vegan
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="mr-2" value="gluten-free"> Gluten-Free
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="mr-2" value="dairy-free"> Dairy-Free
                                </label>
                            </div>
                        </div>

                        <!-- Premium Features -->
                        <div class="mb-4">
                            <label class="block text-gray-700 font-semibold mb-2">Servings (Premium):</label>
                            <select id="servings-select" onchange="updateServings(this.value)" class="input-field">
                                <option value="2">2 servings</option>
                                <option value="4" selected>4 servings</option>
                                <option value="6">6 servings</option>
                                <option value="8">8 servings</option>
                                <option value="10">10 servings</option>
                                <option value="12">12 servings</option>
                            </select>
                        </div>

                        <div class="mb-4">
                            <label class="block text-gray-700 font-semibold mb-2">Cooking Time (Premium):</label>
                            <select id="time-select" onchange="updateCookingTime(this.value)" class="input-field">
                                <option value="any">Any time</option>
                                <option value="quick">Quick (15 min or less)</option>
                                <option value="medium">Medium (15-30 min)</option>
                                <option value="slow">Slow (30+ min)</option>
                            </select>
                        </div>

                        <div class="mb-4">
                            <label class="block text-gray-700 font-semibold mb-2">Cuisine Style (Premium):</label>
                            <select id="cuisine-select" onchange="updateCuisine(this.value)" class="input-field">
                                <option value="any">Any cuisine</option>
                                <option value="italian">Italian</option>
                                <option value="asian">Asian</option>
                                <option value="mexican">Mexican</option>
                                <option value="mediterranean">Mediterranean</option>
                                <option value="indian">Indian</option>
                                <option value="american">American</option>
                            </select>
                        </div>

                        <div class="mb-4">
                            <label class="block text-gray-700 font-semibold mb-2">Difficulty Level (Premium):</label>
                            <select id="difficulty-select" onchange="updateDifficulty(this.value)" class="input-field">
                                <option value="any">Any difficulty</option>
                                <option value="easy">Easy (Beginner)</option>
                                <option value="medium">Medium (Intermediate)</option>
                                <option value="hard">Hard (Advanced)</option>
                            </select>
                        </div>

                        <div class="mb-4">
                            <label class="block text-gray-700 font-semibold mb-2">Meal Planning (Premium):</label>
                            <div class="flex gap-2">
                                <button onclick="addToMealPlan('breakfast')" class="btn-primary text-sm px-3 py-1">Breakfast</button>
                                <button onclick="addToMealPlan('lunch')" class="btn-primary text-sm px-3 py-1">Lunch</button>
                                <button onclick="addToMealPlan('dinner')" class="btn-primary text-sm px-3 py-1">Dinner</button>
                                <button onclick="addToMealPlan('snack')" class="btn-primary text-sm px-3 py-1">Snack</button>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label class="block text-gray-700 font-semibold mb-2">Recipe Collections (Premium):</label>
                            <div class="flex gap-2">
                                <button onclick="navigateToPage('saved-recipes')" class="btn-primary text-sm px-3 py-1">Saved Recipes</button>
                                <button onclick="navigateToPage('shopping-list')" class="btn-primary text-sm px-3 py-1">Shopping List</button>
                                <button onclick="navigateToPage('meal-plan')" class="btn-primary text-sm px-3 py-1">Meal Plan</button>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label class="block text-gray-700 font-semibold mb-2">Smart Features (Premium):</label>
                            <div class="flex gap-2">
                                <button onclick="navigateToPage('cooking-tips')" class="btn-primary text-sm px-3 py-1">Cooking Tips</button>
                                <button onclick="navigateToPage('substitutions')" class="btn-primary text-sm px-3 py-1">Substitutions</button>
                                <button onclick="navigateToPage('wine-pairing')" class="btn-primary text-sm px-3 py-1">Wine Pairing</button>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label class="block text-gray-700 font-semibold mb-2">Recipe Rating (Premium):</label>
                            <div class="flex gap-2">
                                <button onclick="rateRecipe(5)" class="text-2xl">‚òÖ</button>
                                <button onclick="rateRecipe(4)" class="text-2xl">‚òÖ</button>
                                <button onclick="rateRecipe(3)" class="text-2xl">‚òÖ</button>
                                <button onclick="rateRecipe(2)" class="text-2xl">‚òÖ</button>
                                <button onclick="rateRecipe(1)" class="text-2xl">‚òÖ</button>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label class="block text-gray-700 font-semibold mb-2">Cooking Timer (Premium):</label>
                            <div class="flex gap-2">
                                <button onclick="startTimer(5)" class="btn-primary text-sm px-3 py-1">5 min</button>
                                <button onclick="startTimer(10)" class="btn-primary text-sm px-3 py-1">10 min</button>
                                <button onclick="startTimer(15)" class="btn-primary text-sm px-3 py-1">15 min</button>
                                <button onclick="startTimer(30)" class="btn-primary text-sm px-3 py-1">30 min</button>
                                <button onclick="customTimer()" class="btn-primary text-sm px-3 py-1">Custom</button>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label class="block text-gray-700 font-semibold mb-2">Recipe History (Premium):</label>
                            <div class="flex gap-2">
                                <button onclick="navigateToPage('recipe-history')" class="btn-primary text-sm px-3 py-1">History</button>
                                <button onclick="navigateToPage('favorites')" class="btn-primary text-sm px-3 py-1">Favorites</button>
                                <button onclick="navigateToPage('timer')" class="btn-primary text-sm px-3 py-1">Timer</button>
                            </div>
                        </div>

                        <button onclick="generateRecipe()" class="btn-primary w-full py-3">
                            Generate Recipe
                        </button>
                    </div>

                    <!-- Recipe Display -->
                    <div id="recipe-display" class="hidden">
                        <div class="card p-8 recipe-card">
                            <h2 id="recipe-title" class="text-3xl font-bold text-gray-800 mb-4"></h2>
                            <p id="recipe-description" class="text-gray-600 mb-6"></p>
                            
                            <div class="grid md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <h3 class="text-xl font-semibold text-gray-800 mb-3">Ingredients:</h3>
                                    <ul id="recipe-ingredients" class="space-y-2"></ul>
                                </div>
                                <div>
                                    <h3 class="text-xl font-semibold text-gray-800 mb-3">Instructions:</h3>
                                    <ol id="recipe-instructions" class="space-y-3"></ol>
                                </div>
                            </div>

                            <div class="flex flex-wrap gap-4 text-sm text-gray-600">
                                <div class="flex items-center">
                                    <span class="font-semibold">Cooking Time:</span>
                                    <span id="cooking-time" class="ml-2"></span>
                                </div>
                                <div class="flex items-center">
                                    <span class="font-semibold">Servings:</span>
                                    <span id="servings" class="ml-2"></span>
                                </div>
                                <div class="flex items-center">
                                    <span class="font-semibold">Calories:</span>
                                    <span id="calories" class="ml-2"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Premium Modal -->
                    <div id="premium-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                        <div class="bg-white rounded-lg p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                            <div class="flex justify-between items-center mb-6">
                                <h2 class="text-3xl font-bold text-gray-800">Premium Features</h2>
                                <button onclick="hidePremiumModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                            </div>
                            
                            <!-- Premium Status Section -->
                            <div id="premium-status" class="mb-6 p-4 bg-green-50 border border-green-200 rounded-lg hidden">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <h3 class="text-lg font-bold text-green-800">Premium Active</h3>
                                        <p class="text-sm text-green-600">You have access to all premium features</p>
                                    </div>
                                    <button onclick="cancelPremium()" class="btn-primary bg-red-500 hover:bg-red-600 px-4 py-2 text-sm">
                                        Cancel Premium
                                    </button>
                                </div>
                            </div>
                            </div>
                            
                            <!-- Premium Plans -->
                            <div class="grid md:grid-cols-2 gap-6 mb-6">
                                <div class="border-2 border-gray-200 rounded-lg p-6 hover:border-pink-300 transition-colors">
                                    <h3 class="text-xl font-bold text-gray-800 mb-2">Monthly Plan</h3>
                                    <div class="text-3xl font-bold text-pink-500 mb-2">$9.99<span class="text-lg text-gray-500">/month</span></div>
                                    <ul class="space-y-2 text-gray-600 mb-4">
                                        <li>‚úì Unlimited recipe generation</li>
                                        <li>‚úì Advanced dietary filters</li>
                                        <li>‚úì Recipe scaling (2-12 servings)</li>
                                        <li>‚úì Nutritional information</li>
                                        <li>‚úì Recipe collections</li>
                                        <li>‚úì Ad-free experience</li>
                                    </ul>
                                    <button onclick="selectPlan('monthly')" class="btn-primary w-full">Choose Monthly</button>
                                </div>
                                
                                <div class="border-2 border-pink-300 rounded-lg p-6 bg-pink-50 relative">
                                    <div class="absolute -top-3 left-1/2 transform -translate-x-1/2 bg-pink-500 text-white px-4 py-1 rounded-full text-sm font-bold">BEST VALUE</div>
                                    <h3 class="text-xl font-bold text-gray-800 mb-2">Yearly Plan</h3>
                                    <div class="text-3xl font-bold text-pink-500 mb-2">$79.99<span class="text-lg text-gray-500">/year</span></div>
                                    <div class="text-sm text-green-600 mb-2">Save 33% compared to monthly!</div>
                                    <ul class="space-y-2 text-gray-600 mb-4">
                                        <li>‚úì Everything in Monthly</li>
                                        <li>‚úì Meal planning tools</li>
                                        <li>‚úì Shopping list generator</li>
                                        <li>‚úì Recipe sharing</li>
                                        <li>‚úì Priority support</li>
                                        <li>‚úì Early access to new features</li>
                                    </ul>
                                    <button onclick="selectPlan('yearly')" class="btn-primary w-full">Choose Yearly</button>
                                </div>
                            </div>
                            
                            <!-- Payment Form -->
                            <div id="payment-form" class="hidden">
                                <h3 class="text-xl font-bold text-gray-800 mb-4">Payment Information</h3>
                                <div class="grid md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <label class="block text-gray-700 font-semibold mb-2">Card Number</label>
                                        <input type="text" id="card-number" class="input-field" placeholder="1234 5678 9012 3456">
                                    </div>
                                    <div>
                                        <label class="block text-gray-700 font-semibold mb-2">Expiry Date</label>
                                        <input type="text" id="card-expiry" class="input-field" placeholder="MM/YY">
                                    </div>
                                    <div>
                                        <label class="block text-gray-700 font-semibold mb-2">CVV</label>
                                        <input type="text" id="card-cvv" class="input-field" placeholder="123">
                                    </div>
                                    <div>
                                        <label class="block text-gray-700 font-semibold mb-2">Name on Card</label>
                                        <input type="text" id="card-name" class="input-field" placeholder="John Doe">
                                    </div>
                                </div>
                                <div class="flex justify-between items-center">
                                    <div class="text-lg font-bold text-gray-800">
                                        Total: <span id="plan-price">$9.99</span>
                                    </div>
                                    <button onclick="processPayment()" class="btn-primary px-8 py-3">
                                        Pay Now
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Reset ingredient count
                ingredientCount = 1;
            } else {
                // If not premium, just reload
                location.reload();
            }
        }

        // Missing page functions
        function showWinePairingPage() {
            currentPage = 'wine-pairing';
            const mainContent = document.querySelector('.container');
            mainContent.innerHTML = `
                <div class="text-center mb-8">
                    <button onclick="goBack()" class="btn-primary mb-4">‚Üê Back to Recipe Generator</button>
                    <h1 class="text-4xl font-bold text-gray-800 mb-2">Wine Pairing Guide</h1>
                    <p class="text-gray-600">Expert wine recommendations for your dishes!</p>
                </div>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="card p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Red Wines</h3>
                        <ul class="space-y-2 text-gray-700">
                            <li><strong>Cabernet Sauvignon:</strong> Beef, lamb, aged cheese</li>
                            <li><strong>Pinot Noir:</strong> Chicken, salmon, mushrooms</li>
                            <li><strong>Merlot:</strong> Pork, pasta, soft cheese</li>
                            <li><strong>Syrah:</strong> Spicy dishes, grilled meats</li>
                        </ul>
                    </div>
                    
                    <div class="card p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">White Wines</h3>
                        <ul class="space-y-2 text-gray-700">
                            <li><strong>Chardonnay:</strong> Fish, chicken, creamy sauces</li>
                            <li><strong>Sauvignon Blanc:</strong> Seafood, goat cheese, herbs</li>
                            <li><strong>Pinot Grigio:</strong> Light pasta, salads, shellfish</li>
                            <li><strong>Riesling:</strong> Spicy food, Asian cuisine</li>
                        </ul>
                    </div>
                    
                    <div class="card p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Sparkling & Dessert</h3>
                        <ul class="space-y-2 text-gray-700">
                            <li><strong>Champagne:</strong> Appetizers, celebrations</li>
                            <li><strong>Prosecco:</strong> Light appetizers, brunch</li>
                            <li><strong>Port:</strong> Chocolate, blue cheese</li>
                            <li><strong>Sauternes:</strong> Foie gras, sweet desserts</li>
                        </ul>
                    </div>
                    
                    <div class="card p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">General Rules</h3>
                        <ul class="space-y-2 text-gray-700">
                            <li>‚Ä¢ White wines with light dishes</li>
                            <li>‚Ä¢ Red wines with hearty dishes</li>
                            <li>‚Ä¢ Sparkling wines with appetizers</li>
                            <li>‚Ä¢ Sweet wines with desserts</li>
                        </ul>
                    </div>
                </div>
            `;
        }

        function showSavedRecipesPage() {
            currentPage = 'saved-recipes';
            const savedRecipes = JSON.parse(localStorage.getItem('savedRecipes') || '[]');
            const mainContent = document.querySelector('.container');
            
            let recipesHtml = '';
            if (savedRecipes.length === 0) {
                recipesHtml = `
                    <div class="text-center text-gray-500 py-8">
                        <h3 class="text-xl font-bold text-gray-700 mb-2">No saved recipes yet!</h3>
                        <p class="text-gray-500">Generate and save recipes to see them here.</p>
                    </div>
                `;
            } else {
                // Sort recipes by save date (newest first)
                savedRecipes.sort((a, b) => new Date(b.savedAt) - new Date(a.savedAt));
                
                savedRecipes.forEach((recipe, index) => {
                    const savedDate = new Date(recipe.savedAt).toLocaleDateString();
                    const ingredientsList = recipe.ingredients.map(ing => 
                        `<span class="ingredient-tag text-xs mr-1 mb-1">${ing.amount} ${ing.unit} ${ing.item}</span>`
                    ).join('');
                    
                    recipesHtml += `
                        <div class="card p-6 mb-4 hover:shadow-lg transition-shadow">
                            <div class="flex justify-between items-start mb-4">
                                <div class="flex-1">
                                    <h3 class="text-xl font-bold text-gray-800 mb-2">${recipe.title}</h3>
                                    <p class="text-gray-600 mb-3">${recipe.description}</p>
                                    
                                    <div class="flex flex-wrap gap-4 text-sm text-gray-600 mb-3">
                                        <div class="flex items-center">
                                            <span class="font-semibold">Time:</span>
                                            <span class="ml-1">${recipe.cookingTime}</span>
                                        </div>
                                        <div class="flex items-center">
                                            <span class="font-semibold">Servings:</span>
                                            <span class="ml-1">${recipe.servings}</span>
                                        </div>
                                        <div class="flex items-center">
                                            <span class="font-semibold">Calories:</span>
                                            <span class="ml-1">${recipe.calories}</span>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <h4 class="font-semibold text-gray-700 mb-2">Ingredients:</h4>
                                        <div class="flex flex-wrap">
                                            ${ingredientsList}
                                        </div>
                                    </div>
                                    
                                    <p class="text-sm text-gray-500">Saved: ${savedDate}</p>
                                </div>
                                
                                <div class="flex flex-col gap-2 ml-4">
                                    <button onclick="viewRecipe('${recipe.title}')" class="btn-primary text-sm px-3 py-1">
                                        View Full
                                    </button>
                                    <button onclick="addIngredientsToShoppingList('${recipe.title}')" class="btn-primary text-sm px-3 py-1 bg-blue-500 hover:bg-blue-600">
                                        Add to Shopping List
                                    </button>
                                    <button onclick="removeRecipe('${recipe.title}')" class="btn-primary text-sm px-3 py-1 bg-red-500 hover:bg-red-600">
                                        Delete
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                });
            }
            
            mainContent.innerHTML = `
                <div class="text-center mb-8">
                    <button onclick="goBack()" class="btn-primary mb-4">‚Üê Back to Recipe Generator</button>
                    <h1 class="text-4xl font-bold text-gray-800 mb-2">Saved Recipes</h1>
                    <p class="text-gray-600">Your personal recipe collection (${savedRecipes.length} recipes)</p>
                </div>
                ${recipesHtml}
            `;
        }

        function showShoppingListPage() {
            currentPage = 'shopping-list';
            const shoppingList = JSON.parse(localStorage.getItem('shoppingList') || '[]');
            const mainContent = document.querySelector('.container');
            
            let itemsHtml = '';
            if (shoppingList.length === 0) {
                itemsHtml = `
                    <div class="text-center text-gray-500 py-8">
                        <h3 class="text-xl font-bold text-gray-700 mb-2">Shopping list is empty!</h3>
                        <p class="text-gray-500">Add ingredients from recipes to see them here.</p>
                    </div>
                `;
            } else {
                // Group items by recipe source
                const groupedItems = {};
                shoppingList.forEach(item => {
                    const source = item.fromRecipe || 'Manual';
                    if (!groupedItems[source]) {
                        groupedItems[source] = [];
                    }
                    groupedItems[source].push(item);
                });
                
                Object.entries(groupedItems).forEach(([source, items]) => {
                    itemsHtml += `
                        <div class="card p-4 mb-4">
                            <h3 class="font-bold text-gray-800 mb-3">${source}</h3>
                    `;
                    
                    items.forEach((item, index) => {
                        const globalIndex = shoppingList.findIndex(i => 
                            i.item === item.item && i.amount === item.amount && i.unit === item.unit
                        );
                        itemsHtml += `
                            <div class="flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0">
                                <div class="flex items-center">
                                    <span class="font-medium">${item.amount} ${item.unit} ${item.item}</span>
                                    ${item.fromRecipe ? `<span class="text-xs text-gray-500 ml-2">(from recipe)</span>` : ''}
                                </div>
                                <button onclick="removeFromShoppingList(${globalIndex})" class="btn-primary text-sm px-2 py-1 bg-red-500 hover:bg-red-600">
                                    Remove
                                </button>
                            </div>
                        `;
                    });
                    
                    itemsHtml += '</div>';
                });
            }
            
            mainContent.innerHTML = `
                <div class="text-center mb-8">
                    <button onclick="goBack()" class="btn-primary mb-4">‚Üê Back to Recipe Generator</button>
                    <h1 class="text-4xl font-bold text-gray-800 mb-2">Shopping List</h1>
                    <p class="text-gray-600">Your grocery shopping items (${shoppingList.length} items)</p>
                </div>
                ${itemsHtml}
            `;
        }

        function showMealPlanPage() {
            currentPage = 'meal-plan';
            const mealPlan = JSON.parse(localStorage.getItem('mealPlan') || '{}');
            const mainContent = document.querySelector('.container');
            
            let planHtml = '';
            const mealTypes = ['breakfast', 'lunch', 'dinner', 'snack'];
            let hasMeals = false;
            
            mealTypes.forEach(mealType => {
                if (mealPlan[mealType] && mealPlan[mealType].length > 0) {
                    hasMeals = true;
                    planHtml += `
                        <div class="card p-6 mb-4">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">${mealType.charAt(0).toUpperCase() + mealType.slice(1)}</h3>
                    `;
                    mealPlan[mealType].forEach(recipe => {
                        planHtml += `
                            <div class="mb-2 p-3 bg-gray-50 rounded">
                                <strong>${recipe.title}</strong>
                                <p class="text-sm text-gray-600">${recipe.description}</p>
                            </div>
                        `;
                    });
                    planHtml += '</div>';
                }
            });
            
            if (!hasMeals) {
                planHtml = '<div class="text-center text-gray-500">No meals planned yet!</div>';
            }
            
            mainContent.innerHTML = `
                <div class="text-center mb-8">
                    <button onclick="goBack()" class="btn-primary mb-4">‚Üê Back to Recipe Generator</button>
                    <h1 class="text-4xl font-bold text-gray-800 mb-2">Meal Plan</h1>
                    <p class="text-gray-600">Your weekly meal organization</p>
                </div>
                ${planHtml}
            `;
        }

        function showRecipeHistoryPage() {
            currentPage = 'recipe-history';
            const history = JSON.parse(localStorage.getItem('recipeHistory') || '[]');
            const mainContent = document.querySelector('.container');
            
            let historyHtml = '';
            if (history.length === 0) {
                historyHtml = '<div class="text-center text-gray-500">No recipe history yet!</div>';
            } else {
                history.slice(-10).reverse().forEach((recipe, index) => {
                    historyHtml += `
                        <div class="card p-4 mb-2">
                            <h3 class="font-bold text-gray-800">${recipe.title}</h3>
                            <p class="text-sm text-gray-500">Generated: ${new Date(recipe.date).toLocaleDateString()}</p>
                        </div>
                    `;
                });
            }
            
            mainContent.innerHTML = `
                <div class="text-center mb-8">
                    <button onclick="goBack()" class="btn-primary mb-4">‚Üê Back to Recipe Generator</button>
                    <h1 class="text-4xl font-bold text-gray-800 mb-2">Recipe History</h1>
                    <p class="text-gray-600">Your recent recipe generations</p>
                </div>
                ${historyHtml}
            `;
        }

        function showFavoritesPage() {
            currentPage = 'favorites';
            const ratings = JSON.parse(localStorage.getItem('recipeRatings') || '{}');
            const favorites = Object.entries(ratings).filter(([title, data]) => data.rating >= 4);
            const mainContent = document.querySelector('.container');
            
            let favoritesHtml = '';
            if (favorites.length === 0) {
                favoritesHtml = '<div class="text-center text-gray-500">No favorite recipes yet!</div>';
            } else {
                favorites.forEach(([title, data]) => {
                    favoritesHtml += `
                        <div class="card p-4 mb-2">
                            <h3 class="font-bold text-gray-800">${title}</h3>
                            <p class="text-sm text-gray-500">Rated: ${'‚òÖ'.repeat(data.rating)} (${data.rating}/5)</p>
                        </div>
                    `;
                });
            }
            
            mainContent.innerHTML = `
                <div class="text-center mb-8">
                    <button onclick="goBack()" class="btn-primary mb-4">‚Üê Back to Recipe Generator</button>
                    <h1 class="text-4xl font-bold text-gray-800 mb-2">Favorite Recipes</h1>
                    <p class="text-gray-600">Your highest rated recipes</p>
                </div>
                ${favoritesHtml}
            `;
        }

        function showTimerPage() {
            currentPage = 'timer';
            const mainContent = document.querySelector('.container');
            mainContent.innerHTML = `
                <div class="text-center mb-8">
                    <button onclick="goBack()" class="btn-primary mb-4">‚Üê Back to Recipe Generator</button>
                    <h1 class="text-4xl font-bold text-gray-800 mb-2">Cooking Timer</h1>
                    <p class="text-gray-600">Set timers for your cooking steps</p>
                </div>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="card p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Quick Timers</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <button onclick="startTimer(5)" class="btn-primary">5 min</button>
                            <button onclick="startTimer(10)" class="btn-primary">10 min</button>
                            <button onclick="startTimer(15)" class="btn-primary">15 min</button>
                            <button onclick="startTimer(30)" class="btn-primary">30 min</button>
                        </div>
                    </div>
                    
                    <div class="card p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Custom Timer</h3>
                        <input type="number" id="custom-timer" placeholder="Enter minutes" class="input-field mb-4">
                        <button onclick="startCustomTimer()" class="btn-primary w-full">Start Custom Timer</button>
                    </div>
                </div>
            `;
        }

        function startCustomTimer() {
            const minutes = document.getElementById('custom-timer').value;
            if (minutes && !isNaN(minutes)) {
                startTimer(parseInt(minutes));
            }
        }

        function removeFromShoppingList(index) {
            const shoppingList = JSON.parse(localStorage.getItem('shoppingList') || '[]');
            shoppingList.splice(index, 1);
            localStorage.setItem('shoppingList', JSON.stringify(shoppingList));
            showShoppingListPage();
        }

        // Enhanced recipe generation with history tracking
        function generateRecipe() {
            const ingredients = [];
            for (let i = 0; i < ingredientCount; i++) {
                const input = document.getElementById(`ingredient-${i}`);
                if (input && input.value.trim()) {
                    ingredients.push(input.value.trim());
                }
            }

            if (ingredients.length === 0) {
                alert('Please add at least one ingredient!');
                return;
            }

            // Get dietary restrictions
            const restrictions = [];
            document.querySelectorAll('input[type="checkbox"]:checked').forEach(cb => {
                restrictions.push(cb.value);
            });

            // Generate recipe based on ingredients
            const recipe = generateRecipeFromIngredients(ingredients, restrictions);
            
            // Track recipe in history
            const history = JSON.parse(localStorage.getItem('recipeHistory') || '[]');
            history.push({
                ...recipe,
                date: new Date().toISOString(),
                ingredients: ingredients
            });
            localStorage.setItem('recipeHistory', JSON.stringify(history));
            
            displayRecipe(recipe);
        }

        // Smart features functions
        function showCookingTips() {
            const tips = [
                "üî™ Always sharpen your knives before cooking for cleaner cuts",
                "üå°Ô∏è Let meat rest for 5-10 minutes after cooking for juicier results",
                "üßÇ Season in layers - add salt throughout the cooking process",
                "üî• Preheat your pan before adding ingredients for better searing",
                "üßÑ Mince garlic finely for stronger flavor, chop coarsely for milder taste",
                "ü•ò Use a wooden spoon for stirring to avoid scratching non-stick pans",
                "üåø Add fresh herbs at the end of cooking to preserve their flavor",
                "üíß Keep a bowl of water nearby to test if oil is hot enough (should sizzle)",
                "üìè Use a meat thermometer for perfectly cooked proteins",
                "ü•Ñ Taste as you cook and adjust seasoning gradually"
            ];
            
            const randomTip = tips[Math.floor(Math.random() * tips.length)];
            alert(`üí° Cooking Tip:\n\n${randomTip}`);
        }

        function showSubstitutions() {
            const substitutions = {
                "butter": "Olive oil, coconut oil, or applesauce (for baking)",
                "eggs": "Flax seeds + water, mashed banana, or commercial egg replacer",
                "milk": "Almond milk, soy milk, oat milk, or coconut milk",
                "flour": "Almond flour, coconut flour, or gluten-free flour blend",
                "sugar": "Honey, maple syrup, stevia, or coconut sugar",
                "salt": "Herbs, spices, or lemon juice for flavor",
                "garlic": "Garlic powder, shallots, or onion",
                "onion": "Shallots, leeks, or green onions",
                "tomato sauce": "Crushed tomatoes, tomato paste + water, or fresh tomatoes",
                "cream": "Coconut milk, cashew cream, or Greek yogurt"
            };
            
            let subText = "üîÑ Common Ingredient Substitutions:\n\n";
            Object.entries(substitutions).forEach(([ingredient, sub]) => {
                subText += `${ingredient}: ${sub}\n\n`;
            });
            
            alert(subText);
        }

        function showWinePairing() {
            const winePairings = {
                "chicken": "üç∑ Chardonnay, Pinot Grigio, or Sauvignon Blanc",
                "beef": "üç∑ Cabernet Sauvignon, Merlot, or Malbec",
                "salmon": "üç∑ Pinot Noir, Chardonnay, or Riesling",
                "pasta": "üç∑ Chianti, Pinot Grigio, or Barbera",
                "seafood": "üç∑ Sauvignon Blanc, Pinot Grigio, or Albari√±o",
                "pork": "üç∑ Pinot Noir, Chardonnay, or Riesling",
                "lamb": "üç∑ Cabernet Sauvignon, Syrah, or Bordeaux",
                "vegetarian": "üç∑ Pinot Noir, Chardonnay, or Sauvignon Blanc",
                "spicy": "üç∑ Riesling, Gew√ºrztraminer, or Moscato",
                "dessert": "üç∑ Port, Sauternes, or Ice Wine"
            };
            
            const currentRecipe = getCurrentRecipe();
            let pairing = "üç∑ Wine Pairing Suggestions:\n\n";
            
            if (currentRecipe) {
                const title = currentRecipe.title.toLowerCase();
                let found = false;
                
                Object.entries(winePairings).forEach(([food, wine]) => {
                    if (title.includes(food)) {
                        pairing += `For ${currentRecipe.title}:\n${wine}\n\n`;
                        found = true;
                    }
                });
                
                if (!found) {
                    pairing += "General pairing tips:\n‚Ä¢ White wines with light dishes\n‚Ä¢ Red wines with hearty dishes\n‚Ä¢ Sparkling wines with appetizers\n‚Ä¢ Sweet wines with desserts";
                }
            } else {
                pairing += "Generate a recipe first to get specific wine pairing suggestions!";
            }
            
            alert(pairing);
        }

        function createMultiIngredientRecipe(ingredients, restrictions) {
            console.log('createMultiIngredientRecipe called with:', ingredients, restrictions);
            // Include ALL ingredients in the recipe, not just the first one
            const allIngredients = ingredients.map(ing => ing.toLowerCase());
            console.log('All ingredients (lowercase):', allIngredients);
            
            // Define specific multi-ingredient recipes based on common combinations
            const multiRecipes = {
                'chicken,rice': {
                    title: 'Chicken and Rice Pilaf',
                    description: 'Aromatic chicken and rice with herbs and vegetables',
                    ingredients: [
                        { item: 'chicken breast', amount: '1', unit: 'pound' },
                        { item: 'rice', amount: '2', unit: 'cups' },
                        { item: 'onion', amount: '1', unit: 'medium' },
                        { item: 'garlic', amount: '3', unit: 'cloves' },
                        { item: 'chicken broth', amount: '4', unit: 'cups' },
                        { item: 'butter', amount: '2', unit: 'tablespoons' },
                        { item: 'parsley', amount: '1/4', unit: 'cup' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Season chicken with salt and pepper',
                        'Heat butter in a large pot over medium heat',
                        'Brown chicken on both sides, then remove',
                        'Add chopped onion and garlic, cook until soft',
                        'Add rice and stir for 1 minute',
                        'Add chicken broth and return chicken to pot',
                        'Simmer covered for 20 minutes until rice is tender',
                        'Garnish with parsley and serve'
                    ],
                    cookingTime: '35 minutes',
                    servings: '4 servings',
                    calories: '420 calories per serving'
                },
                'chicken,broccoli': {
                    title: 'Chicken and Broccoli Stir-Fry',
                    description: 'Classic Chinese-style chicken and broccoli',
                    ingredients: [
                        { item: 'chicken breast', amount: '1', unit: 'pound' },
                        { item: 'broccoli', amount: '1', unit: 'head' },
                    { item: 'soy sauce', amount: '3', unit: 'tablespoons' },
                    { item: 'garlic', amount: '3', unit: 'cloves' },
                    { item: 'ginger', amount: '1', unit: 'tablespoon' },
                        { item: 'vegetable oil', amount: '2', unit: 'tablespoons' },
                        { item: 'sesame oil', amount: '1', unit: 'teaspoon' }
                    ],
                    instructions: [
                        'Cut chicken into bite-sized pieces',
                        'Heat oil in a wok over high heat',
                        'Add chicken and stir-fry for 4 minutes',
                        'Add minced garlic and ginger',
                        'Add broccoli and stir-fry for 3 minutes',
                        'Add soy sauce and sesame oil',
                    'Serve hot with steamed rice'
                    ],
                    cookingTime: '15 minutes',
                    servings: '4 servings',
                    calories: '280 calories per serving'
                },
                'beef,potato': {
                    title: 'Beef and Potato Stew',
                    description: 'Hearty beef stew with tender potatoes',
                    ingredients: [
                        { item: 'beef chuck', amount: '2', unit: 'pounds' },
                        { item: 'potatoes', amount: '4', unit: 'medium' },
                        { item: 'onion', amount: '1', unit: 'large' },
                        { item: 'carrots', amount: '3', unit: 'medium' },
                        { item: 'beef broth', amount: '4', unit: 'cups' },
                        { item: 'tomato paste', amount: '2', unit: 'tablespoons' },
                        { item: 'thyme', amount: '1', unit: 'teaspoon' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Cut beef into cubes and season with salt and pepper',
                        'Brown beef in oil in a large pot',
                        'Add chopped onion and cook until soft',
                        'Add broth, tomato paste, and thyme',
                        'Simmer covered for 1 hour',
                        'Add cubed potatoes and carrots',
                        'Continue cooking for 30 minutes until tender',
                        'Serve hot with crusty bread'
                    ],
                    cookingTime: '1 hour 45 minutes',
                    servings: '6 servings',
                    calories: '380 calories per serving'
                },
                'salmon,spinach': {
                    title: 'Salmon with Spinach and Lemon',
                    description: 'Pan-seared salmon with fresh spinach',
                    ingredients: [
                        { item: 'salmon fillets', amount: '4', unit: 'pieces' },
                        { item: 'spinach', amount: '1', unit: 'pound' },
                    { item: 'lemon', amount: '1', unit: 'whole' },
                        { item: 'garlic', amount: '3', unit: 'cloves' },
                        { item: 'butter', amount: '3', unit: 'tablespoons' },
                        { item: 'olive oil', amount: '2', unit: 'tablespoons' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Season salmon with salt and pepper',
                        'Heat oil in a large skillet over medium heat',
                        'Cook salmon skin-side down for 4 minutes',
                        'Flip and cook for 3 more minutes, then remove',
                        'Add butter and minced garlic to the same pan',
                        'Add spinach and cook until wilted',
                        'Squeeze lemon juice over spinach',
                        'Serve salmon over spinach'
                    ],
                    cookingTime: '15 minutes',
                    servings: '4 servings',
                    calories: '320 calories per serving'
                },
                'pasta,tomato': {
                    title: 'Pasta with Fresh Tomato Sauce',
                    description: 'Simple pasta with fresh tomatoes and basil',
                    ingredients: [
                        { item: 'spaghetti', amount: '1', unit: 'pound' },
                        { item: 'tomatoes', amount: '4', unit: 'large' },
                        { item: 'basil', amount: '1/2', unit: 'cup' },
                        { item: 'garlic', amount: '4', unit: 'cloves' },
                        { item: 'olive oil', amount: '1/4', unit: 'cup' },
                        { item: 'parmesan cheese', amount: '1/2', unit: 'cup' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Cook pasta according to package directions',
                        'Dice tomatoes and mince garlic',
                        'Heat olive oil in a large skillet',
                        'Add garlic and cook for 1 minute',
                        'Add tomatoes and cook for 5 minutes',
                        'Add cooked pasta and basil',
                        'Top with parmesan cheese and serve'
                    ],
                    cookingTime: '20 minutes',
                    servings: '4 servings',
                    calories: '380 calories per serving'
                },
                'egg,spinach': {
                    title: 'Spinach and Egg Breakfast',
                    description: 'Nutritious breakfast with eggs and fresh spinach',
                    ingredients: [
                        { item: 'eggs', amount: '6', unit: 'large' },
                        { item: 'spinach', amount: '2', unit: 'cups' },
                        { item: 'onion', amount: '1', unit: 'small' },
                    { item: 'garlic', amount: '2', unit: 'cloves' },
                        { item: 'butter', amount: '2', unit: 'tablespoons' },
                        { item: 'cheddar cheese', amount: '1/2', unit: 'cup' },
                    { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Saut√© chopped onion in butter until soft',
                        'Add minced garlic and cook for 1 minute',
                        'Add spinach and cook until wilted',
                        'Whisk eggs with salt and pepper',
                        'Pour eggs over spinach mixture',
                        'Sprinkle cheese on top',
                        'Cook until eggs are set, about 3 minutes',
                        'Serve hot'
                    ],
                    cookingTime: '15 minutes',
                    servings: '4 servings',
                    calories: '220 calories per serving'
                },
                'chicken,cauliflower': {
                    title: 'Chicken and Cauliflower Curry',
                    description: 'Aromatic chicken curry with tender cauliflower',
                    ingredients: [
                        { item: 'chicken breast', amount: '1', unit: 'pound' },
                        { item: 'cauliflower', amount: '1', unit: 'head' },
                        { item: 'coconut milk', amount: '1', unit: 'can' },
                        { item: 'curry powder', amount: '2', unit: 'tablespoons' },
                        { item: 'onion', amount: '1', unit: 'large' },
                        { item: 'garlic', amount: '4', unit: 'cloves' },
                        { item: 'ginger', amount: '1', unit: 'tablespoon' },
                        { item: 'basmati rice', amount: '2', unit: 'cups' }
                    ],
                    instructions: [
                        'Cut chicken into cubes and season with curry powder',
                        'Saut√© onion, garlic, and ginger in oil',
                        'Add chicken and brown on all sides',
                        'Add cauliflower florets and coconut milk',
                        'Simmer for 15 minutes until chicken is cooked',
                        'Serve hot with steamed basmati rice'
                    ],
                    cookingTime: '30 minutes',
                    servings: '4 servings',
                    calories: '380 calories per serving'
                },
                'beef,quinoa': {
                    title: 'Beef and Quinoa Bowl',
                    description: 'Protein-rich bowl with beef and nutritious quinoa',
                    ingredients: [
                        { item: 'beef sirloin', amount: '1', unit: 'pound' },
                        { item: 'quinoa', amount: '2', unit: 'cups' },
                        { item: 'broccoli', amount: '1', unit: 'head' },
                        { item: 'carrots', amount: '3', unit: 'medium' },
                        { item: 'soy sauce', amount: '3', unit: 'tablespoons' },
                        { item: 'sesame oil', amount: '1', unit: 'tablespoon' },
                        { item: 'garlic', amount: '3', unit: 'cloves' },
                        { item: 'ginger', amount: '1', unit: 'tablespoon' }
                    ],
                    instructions: [
                        'Cook quinoa according to package directions',
                        'Slice beef thinly and marinate in soy sauce',
                        'Stir-fry beef in hot oil until browned',
                        'Add vegetables and stir-fry for 3 minutes',
                        'Add garlic, ginger, and sesame oil',
                        'Serve beef and vegetables over quinoa'
                    ],
                    cookingTime: '25 minutes',
                    servings: '4 servings',
                    calories: '420 calories per serving'
                },
                'salmon,asparagus': {
                    title: 'Salmon with Roasted Asparagus',
                    description: 'Elegant salmon with tender roasted asparagus',
                    ingredients: [
                        { item: 'salmon fillets', amount: '4', unit: 'pieces' },
                        { item: 'asparagus', amount: '2', unit: 'pounds' },
                        { item: 'lemon', amount: '2', unit: 'whole' },
                        { item: 'garlic', amount: '4', unit: 'cloves' },
                        { item: 'olive oil', amount: '3', unit: 'tablespoons' },
                        { item: 'butter', amount: '2', unit: 'tablespoons' },
                        { item: 'dill', amount: '2', unit: 'tablespoons' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Preheat oven to 400¬∞F',
                        'Toss asparagus with olive oil, garlic, and lemon',
                        'Roast asparagus for 12 minutes',
                        'Season salmon and cook in skillet for 4 minutes per side',
                        'Add butter and dill to salmon',
                        'Serve salmon over roasted asparagus'
                    ],
                    cookingTime: '20 minutes',
                    servings: '4 servings',
                    calories: '340 calories per serving'
                },
                'pasta,spinach': {
                    title: 'Creamy Spinach Pasta',
                    description: 'Rich pasta with creamy spinach sauce',
                    ingredients: [
                        { item: 'linguine', amount: '1', unit: 'pound' },
                        { item: 'spinach', amount: '1', unit: 'pound' },
                        { item: 'heavy cream', amount: '1', unit: 'cup' },
                        { item: 'parmesan cheese', amount: '1', unit: 'cup' },
                        { item: 'garlic', amount: '4', unit: 'cloves' },
                        { item: 'butter', amount: '3', unit: 'tablespoons' },
                        { item: 'nutmeg', amount: '1/4', unit: 'teaspoon' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Cook pasta according to package directions',
                        'Saut√© garlic in butter until fragrant',
                        'Add spinach and cook until wilted',
                        'Add cream and simmer for 3 minutes',
                        'Stir in parmesan cheese and nutmeg',
                        'Add cooked pasta and toss to coat',
                        'Serve hot with extra parmesan'
                    ],
                    cookingTime: '20 minutes',
                    servings: '4 servings',
                    calories: '480 calories per serving'
                },
                'chicken,lentils': {
                    title: 'Chicken and Lentil Stew',
                    description: 'Hearty stew with tender chicken and nutritious lentils',
                    ingredients: [
                        { item: 'chicken thighs', amount: '1', unit: 'pound' },
                        { item: 'lentils', amount: '2', unit: 'cups' },
                        { item: 'onion', amount: '1', unit: 'large' },
                        { item: 'carrots', amount: '4', unit: 'medium' },
                        { item: 'celery', amount: '3', unit: 'stalks' },
                        { item: 'chicken broth', amount: '6', unit: 'cups' },
                        { item: 'thyme', amount: '1', unit: 'teaspoon' },
                        { item: 'bay leaves', amount: '2', unit: 'pieces' }
                    ],
                    instructions: [
                        'Brown chicken thighs in oil',
                        'Add chopped vegetables and cook until soft',
                        'Add lentils, broth, and herbs',
                        'Simmer for 30 minutes until lentils are tender',
                        'Remove chicken, shred, and return to pot',
                        'Season to taste and serve hot'
                    ],
                    cookingTime: '45 minutes',
                    servings: '6 servings',
                    calories: '320 calories per serving'
                }
            };
            
            // Try to find a specific multi-ingredient recipe
            const ingredientKey = allIngredients.sort().join(',');
            console.log('Looking for multi-ingredient recipe with key:', ingredientKey);
            console.log('Available keys:', Object.keys(multiRecipes));
            console.log('Dietary restrictions:', restrictions);
            
            if (multiRecipes[ingredientKey]) {
                console.log('Found specific multi-ingredient recipe:', multiRecipes[ingredientKey].title);
                let recipe = multiRecipes[ingredientKey];
                
                // Apply dietary restrictions
                if (restrictions && restrictions.length > 0) {
                    recipe = applyDietaryRestrictions(recipe, restrictions);
                }
                
                return recipe;
            }
            
            // If no specific recipe found, create a custom one using the existing single recipes
            const availableRecipes = {
                'chicken': {
                    title: 'Classic Chicken Cacciatore',
                    description: 'Traditional Italian hunter-style chicken with tomatoes and herbs',
                    ingredients: [
                        { item: 'chicken pieces (legs and thighs)', amount: '3', unit: 'pounds' },
                        { item: 'tomatoes', amount: '4', unit: 'medium' },
                        { item: 'onion', amount: '1', unit: 'large' },
                        { item: 'garlic', amount: '4', unit: 'cloves' },
                        { item: 'bell peppers', amount: '2', unit: 'medium' },
                        { item: 'olive oil', amount: '3', unit: 'tablespoons' },
                        { item: 'dried oregano', amount: '1', unit: 'teaspoon' },
                        { item: 'dried basil', amount: '1', unit: 'teaspoon' },
                        { item: 'red wine', amount: '1/2', unit: 'cup' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Season chicken with salt and pepper',
                        'Heat olive oil in a large Dutch oven over medium heat',
                        'Brown chicken pieces on all sides, about 8 minutes',
                        'Remove chicken and set aside',
                        'Add chopped onion and garlic, cook until softened',
                        'Add chopped tomatoes and bell peppers',
                        'Add oregano, basil, and red wine',
                        'Return chicken to pot and simmer covered for 45 minutes',
                        'Serve hot with crusty bread or pasta'
                    ],
                    cookingTime: '1 hour 15 minutes',
                    servings: '6 servings',
                    calories: '380 calories per serving'
                },
                'beef': {
                    title: 'Traditional Beef Bourguignon',
                    description: 'Classic French beef stew with red wine and mushrooms',
                    ingredients: [
                        { item: 'beef chuck roast', amount: '2', unit: 'pounds' },
                        { item: 'red wine', amount: '2', unit: 'cups' },
                        { item: 'beef broth', amount: '2', unit: 'cups' },
                        { item: 'mushrooms', amount: '1', unit: 'pound' },
                        { item: 'pearl onions', amount: '1', unit: 'cup' },
                        { item: 'carrots', amount: '4', unit: 'medium' },
                        { item: 'garlic', amount: '6', unit: 'cloves' },
                        { item: 'tomato paste', amount: '2', unit: 'tablespoons' },
                        { item: 'thyme', amount: '2', unit: 'sprigs' },
                        { item: 'bay leaves', amount: '2', unit: 'pieces' }
                    ],
                    instructions: [
                        'Cut beef into 2-inch cubes and season with salt and pepper',
                        'Heat oil in a large Dutch oven and brown beef in batches',
                        'Remove beef and add chopped onions and garlic',
                        'Add wine and scrape up browned bits from bottom',
                        'Add beef broth, tomato paste, thyme, and bay leaves',
                        'Return beef to pot and simmer covered for 2 hours',
                        'Add carrots, mushrooms, and pearl onions',
                        'Continue cooking for 30 minutes until vegetables are tender',
                        'Serve with mashed potatoes or crusty bread'
                    ],
                    cookingTime: '2 hours 30 minutes',
                    servings: '6 servings',
                    calories: '450 calories per serving'
                },
                'salmon': {
                    title: 'Traditional Scottish Salmon with Whisky Sauce',
                    description: 'Classic Scottish salmon with a rich whisky cream sauce',
                    ingredients: [
                        { item: 'salmon fillets', amount: '4', unit: 'pieces' },
                        { item: 'scottish whisky', amount: '1/4', unit: 'cup' },
                        { item: 'heavy cream', amount: '1', unit: 'cup' },
                        { item: 'butter', amount: '4', unit: 'tablespoons' },
                        { item: 'shallots', amount: '2', unit: 'medium' },
                        { item: 'dill', amount: '2', unit: 'tablespoons' },
                        { item: 'lemon', amount: '1', unit: 'whole' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Season salmon with salt and pepper',
                        'Heat butter in a large skillet over medium heat',
                        'Cook salmon skin-side down for 4 minutes',
                        'Flip and cook for 3 more minutes, then remove',
                        'Add chopped shallots to the same pan',
                        'Add whisky and let it reduce for 1 minute',
                        'Add cream and simmer until thickened',
                        'Stir in chopped dill and lemon juice',
                        'Pour sauce over salmon and serve'
                    ],
                    cookingTime: '20 minutes',
                    servings: '4 servings',
                    calories: '420 calories per serving'
                },
                'pasta': {
                    title: 'Authentic Carbonara',
                    description: 'Traditional Roman pasta with eggs, cheese, and pancetta',
                    ingredients: [
                        { item: 'spaghetti', amount: '1', unit: 'pound' },
                        { item: 'pancetta', amount: '8', unit: 'ounces' },
                        { item: 'eggs', amount: '4', unit: 'large' },
                        { item: 'pecorino romano', amount: '1', unit: 'cup' },
                        { item: 'black pepper', amount: '2', unit: 'teaspoons' },
                        { item: 'garlic', amount: '3', unit: 'cloves' },
                        { item: 'salt', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Bring a large pot of salted water to boil',
                        'Cook pasta according to package directions (8-10 minutes)',
                        'Meanwhile, melt butter in a large skillet over medium heat',
                        'Add minced garlic and cook for 1 minute until fragrant',
                        'Add cream and simmer for 3 minutes until slightly thickened',
                        'Stir in parmesan cheese until melted and smooth',
                        'Add cooked pasta and toss to coat evenly',
                        'Season with salt and pepper, serve immediately'
                    ],
                    cookingTime: '20 minutes',
                    servings: '4 servings',
                    calories: '580 calories per serving'
                },
                'tomato': {
                    title: 'Fresh Tomato Pasta',
                    description: 'Simple and delicious pasta with fresh tomatoes and basil',
                    ingredients: [
                        { item: 'spaghetti', amount: '1', unit: 'pound' },
                        { item: 'fresh tomatoes', amount: '4', unit: 'large' },
                        { item: 'fresh basil', amount: '1/2', unit: 'cup' },
                        { item: 'garlic', amount: '4', unit: 'cloves' },
                        { item: 'olive oil', amount: '1/4', unit: 'cup' },
                        { item: 'parmesan cheese', amount: '1/2', unit: 'cup' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Bring a large pot of salted water to boil',
                        'Cook spaghetti according to package directions',
                        'Meanwhile, dice tomatoes and mince garlic',
                    'Heat olive oil in a large skillet over medium heat',
                    'Add garlic and cook for 1 minute until fragrant',
                        'Add tomatoes and cook for 5 minutes until softened',
                        'Add cooked pasta and toss with basil',
                        'Top with parmesan cheese and serve'
                    ],
                    cookingTime: '20 minutes',
                    servings: '4 servings',
                    calories: '380 calories per serving'
                },
                'potato': {
                    title: 'Garlic Mashed Potatoes',
                    description: 'Creamy mashed potatoes with roasted garlic',
                    ingredients: [
                        { item: 'potatoes', amount: '3', unit: 'pounds' },
                        { item: 'butter', amount: '1/2', unit: 'cup' },
                        { item: 'milk', amount: '1/2', unit: 'cup' },
                        { item: 'garlic', amount: '6', unit: 'cloves' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Peel and cube potatoes, place in large pot',
                        'Cover with cold water and bring to boil',
                        'Cook for 15-20 minutes until tender',
                        'Meanwhile, roast garlic cloves in foil for 20 minutes',
                        'Drain potatoes and return to pot',
                        'Mash with butter, milk, and roasted garlic',
                        'Season with salt and pepper to taste'
                    ],
                    cookingTime: '30 minutes',
                    servings: '6 servings',
                    calories: '220 calories per serving'
                },
                'egg': {
                    title: 'Scrambled Eggs with Herbs',
                    description: 'Fluffy scrambled eggs with fresh herbs and cheese',
                    ingredients: [
                        { item: 'eggs', amount: '8', unit: 'large' },
                        { item: 'butter', amount: '2', unit: 'tablespoons' },
                        { item: 'milk', amount: '1/4', unit: 'cup' },
                        { item: 'fresh herbs', amount: '2', unit: 'tablespoons' },
                        { item: 'cheddar cheese', amount: '1/2', unit: 'cup' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Crack eggs into a bowl and whisk with milk',
                        'Melt butter in a large skillet over medium-low heat',
                        'Pour in egg mixture and let sit for 30 seconds',
                        'Gently stir with a spatula, folding eggs',
                        'Add herbs and cheese, continue cooking',
                        'Cook until just set but still moist',
                        'Season with salt and pepper, serve immediately'
                    ],
                    cookingTime: '10 minutes',
                    servings: '4 servings',
                    calories: '180 calories per serving'
                },
                'rice': {
                    title: 'Fried Rice',
                    description: 'Classic fried rice with vegetables and soy sauce',
                    ingredients: [
                        { item: 'cooked rice', amount: '4', unit: 'cups' },
                        { item: 'eggs', amount: '3', unit: 'large' },
                        { item: 'mixed vegetables', amount: '2', unit: 'cups' },
                        { item: 'soy sauce', amount: '3', unit: 'tablespoons' },
                        { item: 'sesame oil', amount: '1', unit: 'tablespoon' },
                        { item: 'garlic', amount: '3', unit: 'cloves' },
                        { item: 'green onions', amount: '4', unit: 'pieces' }
                    ],
                    instructions: [
                        'Heat oil in a large wok or skillet over high heat',
                        'Scramble eggs and remove from pan',
                        'Add garlic and vegetables, stir-fry for 2 minutes',
                        'Add rice and break up any clumps',
                        'Add soy sauce and sesame oil',
                        'Return eggs to pan and add green onions',
                        'Stir-fry for 2 more minutes and serve'
                    ],
                    cookingTime: '15 minutes',
                    servings: '4 servings',
                    calories: '320 calories per serving'
                },
                'onion': {
                    title: 'French Onion Soup',
                    description: 'Classic French onion soup with caramelized onions',
                    ingredients: [
                        { item: 'onions', amount: '4', unit: 'large' },
                        { item: 'beef broth', amount: '6', unit: 'cups' },
                        { item: 'butter', amount: '3', unit: 'tablespoons' },
                        { item: 'white wine', amount: '1/2', unit: 'cup' },
                        { item: 'baguette', amount: '1', unit: 'loaf' },
                        { item: 'gruyere cheese', amount: '2', unit: 'cups' },
                        { item: 'thyme', amount: '1', unit: 'teaspoon' }
                    ],
                    instructions: [
                        'Slice onions thinly and melt butter in large pot',
                        'Cook onions over low heat for 45 minutes until caramelized',
                        'Add wine and cook for 2 minutes',
                        'Add broth and thyme, simmer for 30 minutes',
                        'Toast baguette slices under broiler',
                        'Top soup with bread and cheese',
                        'Broil until cheese is melted and bubbly'
                    ],
                    cookingTime: '90 minutes',
                    servings: '4 servings',
                    calories: '420 calories per serving'
                },
                'carrot': {
                    title: 'Honey Glazed Carrots',
                    description: 'Sweet and tender glazed carrots with herbs',
                    ingredients: [
                        { item: 'carrots', amount: '2', unit: 'pounds' },
                        { item: 'honey', amount: '3', unit: 'tablespoons' },
                        { item: 'butter', amount: '2', unit: 'tablespoons' },
                        { item: 'thyme', amount: '1', unit: 'teaspoon' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Peel and slice carrots into uniform pieces',
                        'Melt butter in a large skillet over medium heat',
                        'Add carrots and cook for 5 minutes',
                        'Add honey and thyme, stir to coat',
                        'Cover and cook for 10 minutes until tender',
                        'Season with salt and pepper, serve hot'
                    ],
                    cookingTime: '20 minutes',
                    servings: '4 servings',
                    calories: '140 calories per serving'
                },
                'broccoli': {
                    title: 'Traditional Chinese Stir-Fried Broccoli',
                    description: 'Classic Chinese broccoli with oyster sauce and garlic',
                    ingredients: [
                        { item: 'broccoli', amount: '2', unit: 'heads' },
                        { item: 'oyster sauce', amount: '3', unit: 'tablespoons' },
                        { item: 'garlic', amount: '4', unit: 'cloves' },
                        { item: 'ginger', amount: '1', unit: 'tablespoon' },
                        { item: 'vegetable oil', amount: '2', unit: 'tablespoons' },
                        { item: 'sesame oil', amount: '1', unit: 'teaspoon' },
                        { item: 'soy sauce', amount: '1', unit: 'tablespoon' }
                    ],
                    instructions: [
                        'Cut broccoli into florets and mince garlic and ginger',
                        'Heat vegetable oil in a wok over high heat',
                        'Add garlic and ginger, stir-fry for 30 seconds',
                        'Add broccoli and stir-fry for 2 minutes',
                        'Add oyster sauce, soy sauce, and sesame oil',
                        'Continue cooking for 2 more minutes until tender',
                        'Serve hot with steamed rice'
                    ],
                    cookingTime: '10 minutes',
                    servings: '4 servings',
                    calories: '120 calories per serving'
                },
                'spinach': {
                    title: 'Traditional Greek Spanakopita',
                    description: 'Classic Greek spinach pie with feta and phyllo dough',
                    ingredients: [
                        { item: 'spinach', amount: '2', unit: 'pounds' },
                        { item: 'feta cheese', amount: '1', unit: 'pound' },
                        { item: 'phyllo dough', amount: '1', unit: 'package' },
                        { item: 'onion', amount: '1', unit: 'large' },
                        { item: 'dill', amount: '1/2', unit: 'cup' },
                        { item: 'eggs', amount: '3', unit: 'large' },
                        { item: 'butter', amount: '1/2', unit: 'cup' },
                        { item: 'olive oil', amount: '1/4', unit: 'cup' }
                    ],
                    instructions: [
                        'Wash and chop spinach, removing excess water',
                        'Saut√© chopped onion in olive oil until soft',
                        'Mix spinach with crumbled feta, dill, and beaten eggs',
                        'Layer phyllo sheets with melted butter between each',
                        'Spread spinach mixture over half the phyllo layers',
                        'Fold over remaining layers and brush with butter',
                        'Bake at 375¬∞F for 45 minutes until golden brown',
                        'Let cool for 10 minutes before cutting'
                    ],
                    cookingTime: '1 hour 15 minutes',
                    servings: '8 servings',
                    calories: '320 calories per serving'
                },
                'apple': {
                    title: 'Traditional German Apple Strudel',
                    description: 'Classic German apple strudel with flaky pastry and warm spices',
                    ingredients: [
                        { item: 'apples', amount: '6', unit: 'medium' },
                        { item: 'phyllo dough', amount: '1', unit: 'package' },
                        { item: 'breadcrumbs', amount: '1', unit: 'cup' },
                        { item: 'raisins', amount: '1/2', unit: 'cup' },
                        { item: 'cinnamon', amount: '2', unit: 'teaspoons' },
                        { item: 'sugar', amount: '1/2', unit: 'cup' },
                        { item: 'butter', amount: '1/2', unit: 'cup' },
                        { item: 'lemon', amount: '1', unit: 'whole' },
                        { item: 'vanilla', amount: '1', unit: 'teaspoon' }
                    ],
                    instructions: [
                        'Peel, core, and thinly slice apples',
                        'Mix apples with sugar, cinnamon, raisins, and lemon juice',
                        'Melt butter and brush over phyllo sheets',
                        'Sprinkle breadcrumbs over buttered phyllo',
                        'Spread apple mixture over half the phyllo',
                        'Roll up tightly, tucking in edges',
                        'Brush with remaining butter and bake at 375¬∞F for 45 minutes',
                        'Serve warm with vanilla ice cream'
                    ],
                    cookingTime: '1 hour',
                    servings: '8 servings',
                    calories: '280 calories per serving'
                },
                'banana': {
                    title: 'Banana Bread',
                    description: 'Moist and delicious banana bread with walnuts',
                    ingredients: [
                        { item: 'bananas', amount: '3', unit: 'ripe' },
                        { item: 'flour', amount: '2', unit: 'cups' },
                        { item: 'sugar', amount: '1', unit: 'cup' },
                        { item: 'eggs', amount: '2', unit: 'large' },
                        { item: 'butter', amount: '1/2', unit: 'cup' },
                        { item: 'walnuts', amount: '1/2', unit: 'cup' },
                        { item: 'vanilla', amount: '1', unit: 'teaspoon' }
                    ],
                    instructions: [
                        'Preheat oven to 350¬∞F (175¬∞C)',
                        'Mash bananas in a large bowl',
                        'Cream butter and sugar until fluffy',
                        'Add eggs and vanilla, mix well',
                        'Stir in mashed bananas',
                        'Fold in flour and chopped walnuts',
                        'Pour into greased loaf pan and bake for 60 minutes'
                    ],
                    cookingTime: '60 minutes',
                    servings: '8 servings',
                    calories: '280 calories per serving'
                },
                'mushroom': {
                    title: 'Garlic Mushroom Pasta',
                    description: 'Creamy pasta with saut√©ed mushrooms and garlic',
                    ingredients: [
                        { item: 'mushroom', amount: '1', unit: 'pound' },
                        { item: 'linguine', amount: '1', unit: 'pound' },
                        { item: 'garlic', amount: '4', unit: 'cloves' },
                        { item: 'butter', amount: '3', unit: 'tablespoons' },
                        { item: 'parmesan cheese', amount: '1', unit: 'cup' },
                        { item: 'parsley', amount: '1/4', unit: 'cup' },
                        { item: 'salt and pepper', amount: 'to taste', unit: '' }
                    ],
                    instructions: [
                        'Cook pasta according to package directions',
                        'Slice mushrooms and mince garlic',
                        'Melt butter in large skillet over medium heat',
                        'Add mushrooms and cook for 5 minutes',
                        'Add garlic and cook for 1 minute',
                        'Add cooked pasta and parmesan',
                        'Toss with parsley and season to taste'
                    ],
                    cookingTime: '20 minutes',
                    servings: '4 servings',
                    calories: '420 calories per serving'
                },
                'cheese': {
                    title: 'Grilled Cheese with Tomato Soup',
                    description: 'Classic grilled cheese with homemade tomato soup',
                    ingredients: [
                        { item: 'bread', amount: '8', unit: 'slices' },
                        { item: 'cheddar cheese', amount: '1', unit: 'pound' },
                        { item: 'butter', amount: '4', unit: 'tablespoons' },
                        { item: 'tomatoes', amount: '4', unit: 'large' },
                        { item: 'onion', amount: '1', unit: 'medium' },
                        { item: 'garlic', amount: '2', unit: 'cloves' },
                        { item: 'cream', amount: '1/2', unit: 'cup' }
                    ],
                    instructions: [
                        'Make soup: saut√© onion and garlic in oil',
                        'Add chopped tomatoes and simmer for 20 minutes',
                        'Blend until smooth and add cream',
                        'For sandwiches: butter bread and add cheese',
                        'Grill in skillet until golden and cheese melts',
                        'Serve hot sandwiches with warm soup'
                    ],
                    cookingTime: '30 minutes',
                    servings: '4 servings',
                    calories: '450 calories per serving'
                }
            };
            
            // Find the best matching recipe for the primary ingredient
            let primaryRecipe = null;
            let primaryIngredient = null;
            
            for (const ingredient of allIngredients) {
                if (availableRecipes[ingredient]) {
                    primaryRecipe = availableRecipes[ingredient];
                    primaryIngredient = ingredient;
                    break;
                }
            }
            
            if (primaryRecipe) {
                // Create a custom multi-ingredient recipe based on the primary recipe
                const additionalIngredients = allIngredients.filter(ing => ing !== primaryIngredient);
                
                return {
                    title: `${primaryRecipe.title} with ${additionalIngredients.join(', ')}`,
                    description: `${primaryRecipe.description} enhanced with ${additionalIngredients.join(', ')}`,
                    ingredients: [
                        ...primaryRecipe.ingredients,
                        ...additionalIngredients.map(ing => ({ 
                            item: ing, 
                            amount: '1', 
                            unit: 'cup' 
                        }))
                    ],
                    instructions: [
                        ...primaryRecipe.instructions.slice(0, -1), // Remove the last instruction
                        `Add ${additionalIngredients.join(', ')} and continue cooking for 5 minutes`,
                        primaryRecipe.instructions[primaryRecipe.instructions.length - 1] // Add back the last instruction
                    ],
                    cookingTime: primaryRecipe.cookingTime,
                    servings: primaryRecipe.servings,
                    calories: primaryRecipe.calories
                };
            }
            
            // Fallback: Create a simple medley recipe
            return {
                title: `${ingredients[0]} and ${ingredients.slice(1).join(', ')} Medley`,
                description: `A flavorful dish combining all your ingredients`,
                ingredients: [
                    ...ingredients.map(ing => ({ item: ing, amount: '1', unit: 'cup' })),
                    { item: 'olive oil', amount: '3', unit: 'tablespoons' },
                    { item: 'garlic', amount: '3', unit: 'cloves' },
                    { item: 'fresh herbs', amount: '2', unit: 'tablespoons' },
                    { item: 'lemon', amount: '1', unit: 'whole' },
                    { item: 'salt and pepper', amount: 'to taste', unit: '' }
                ],
                instructions: [
                    'Heat olive oil in a large skillet over medium heat',
                    'Add minced garlic and cook for 1 minute until fragrant',
                    `Add ${ingredients[0]} and cook for 3-4 minutes`,
                    `Add ${ingredients.slice(1).join(', ')} and continue cooking for 2-3 minutes`,
                    'Add fresh herbs and squeeze lemon juice over',
                    'Season with salt and pepper to taste',
                    'Serve hot as a side dish or over rice'
                ],
                cookingTime: '25 minutes',
                servings: '4 servings',
                calories: '250 calories per serving'
            };
        }

        function testRecipeGeneration() {
            console.log('=== TESTING RECIPE GENERATION ===');
            
            // Test single ingredient
            console.log('Testing single ingredient: chicken');
            const singleRecipe = generateRecipeFromIngredients(['chicken'], []);
            console.log('Single ingredient result:', singleRecipe);
            
            // Test multiple ingredients
            console.log('Testing multiple ingredients: chicken, rice');
            const multiRecipe = generateRecipeFromIngredients(['chicken', 'rice'], []);
            console.log('Multiple ingredients result:', multiRecipe);
            
            // Test with restrictions
            console.log('Testing with vegetarian restriction: chicken');
            const restrictedRecipe = generateRecipeFromIngredients(['chicken'], ['Vegetarian']);
            console.log('Restricted recipe result:', restrictedRecipe);
            
            alert('Check browser console (F12) for test results!');
        }

        function applyDietaryRestrictions(recipe, restrictions) {
            console.log('Applying dietary restrictions:', restrictions);
            
            let modifiedRecipe = { ...recipe };
            
            // Vegetarian restrictions
            if (restrictions.includes('Vegetarian') || restrictions.includes('Vegan')) {
                // Replace meat ingredients with vegetarian alternatives
                modifiedRecipe.ingredients = modifiedRecipe.ingredients.map(ingredient => {
                    if (ingredient.item.includes('chicken') || ingredient.item.includes('beef') || 
                        ingredient.item.includes('pork') || ingredient.item.includes('lamb') || 
                        ingredient.item.includes('turkey') || ingredient.item.includes('salmon') ||
                        ingredient.item.includes('shrimp')) {
                        return { ...ingredient, item: 'tofu', amount: '1', unit: 'pound' };
                    }
                    return ingredient;
                });
                
                // Update title and description
                modifiedRecipe.title = modifiedRecipe.title.replace(/Chicken|Beef|Pork|Lamb|Turkey|Salmon|Shrimp/gi, 'Tofu');
                modifiedRecipe.description = modifiedRecipe.description.replace(/chicken|beef|pork|lamb|turkey|salmon|shrimp/gi, 'tofu');
                
                // Update instructions
                modifiedRecipe.instructions = modifiedRecipe.instructions.map(instruction => 
                    instruction.replace(/chicken|beef|pork|lamb|turkey|salmon|shrimp/gi, 'tofu')
                );
            }
            
            // Vegan restrictions
            if (restrictions.includes('Vegan')) {
                // Replace dairy and eggs
                modifiedRecipe.ingredients = modifiedRecipe.ingredients.map(ingredient => {
                    if (ingredient.item.includes('butter') || ingredient.item.includes('cheese') || 
                        ingredient.item.includes('cream') || ingredient.item.includes('milk') ||
                        ingredient.item.includes('eggs')) {
                        return { ...ingredient, item: 'olive oil', amount: '2', unit: 'tablespoons' };
                    }
                    return ingredient;
                });
                
                modifiedRecipe.title = modifiedRecipe.title.replace(/Cheese|Cream|Butter/gi, 'Vegan');
                modifiedRecipe.description = modifiedRecipe.description + ' (Vegan)';
            }
            
            // Gluten-free restrictions
            if (restrictions.includes('Gluten-Free')) {
                // Replace wheat-based ingredients
                modifiedRecipe.ingredients = modifiedRecipe.ingredients.map(ingredient => {
                    if (ingredient.item.includes('pasta') || ingredient.item.includes('bread') || 
                        ingredient.item.includes('flour') || ingredient.item.includes('soy sauce')) {
                        return { ...ingredient, item: 'gluten-free ' + ingredient.item, amount: ingredient.amount, unit: ingredient.unit };
                    }
                    return ingredient;
                });
                
                modifiedRecipe.title = modifiedRecipe.title + ' (Gluten-Free)';
                modifiedRecipe.description = modifiedRecipe.description + ' (Gluten-Free)';
            }
            
            // Low-carb restrictions
            if (restrictions.includes('Low-Carb')) {
                // Replace high-carb ingredients
                modifiedRecipe.ingredients = modifiedRecipe.ingredients.map(ingredient => {
                    if (ingredient.item.includes('rice') || ingredient.item.includes('pasta') || 
                        ingredient.item.includes('potato') || ingredient.item.includes('bread')) {
                        return { ...ingredient, item: 'cauliflower rice', amount: '2', unit: 'cups' };
                    }
                    return ingredient;
                });
                
                modifiedRecipe.title = modifiedRecipe.title + ' (Low-Carb)';
                modifiedRecipe.description = modifiedRecipe.description + ' (Low-Carb)';
            }
            
            console.log('Modified recipe:', modifiedRecipe.title);
            return modifiedRecipe;
        }

        function rateRecipe(rating) {
            const currentRecipe = getCurrentRecipe();
            if (!currentRecipe) {
                alert('Please generate a recipe first!');
                return;
            }
            
            const ratings = JSON.parse(localStorage.getItem('recipeRatings') || '{}');
            ratings[currentRecipe.title] = {
                rating: rating,
                date: new Date().toISOString()
            };
            
            localStorage.setItem('recipeRatings', JSON.stringify(ratings));
            
            const stars = '‚≠ê'.repeat(rating);
            alert(`Rated "${currentRecipe.title}" ${stars} (${rating}/5 stars)`);
        }

        // Meal planning functions
        function addToMealPlan(mealType) {
            const currentRecipe = getCurrentRecipe();
            if (!currentRecipe) {
                alert('Please generate a recipe first!');
                return;
            }
            
            const mealPlan = JSON.parse(localStorage.getItem('mealPlan') || '{}');
            if (!mealPlan[mealType]) {
                mealPlan[mealType] = [];
            }
            
            mealPlan[mealType].push({
                ...currentRecipe,
                addedAt: new Date().toISOString()
            });
            
            localStorage.setItem('mealPlan', JSON.stringify(mealPlan));
            alert(`Added to ${mealType} meal plan!`);
        }

        function getCurrentRecipe() {
            const title = document.getElementById('recipe-title')?.textContent;
            const description = document.getElementById('recipe-description')?.textContent;
            
            if (!title) return null;
            
            return {
                title: title,
                description: description,
                ingredients: [], // Would need to parse from DOM
                instructions: [], // Would need to parse from DOM
                cookingTime: document.getElementById('cooking-time')?.textContent || '',
                servings: document.getElementById('servings')?.textContent || '',
                calories: document.getElementById('calories')?.textContent || ''
            };
        }

        function viewSavedRecipes() {
            const savedRecipes = JSON.parse(localStorage.getItem('savedRecipes') || '[]');
            if (savedRecipes.length === 0) {
                alert('No saved recipes yet! Save a recipe to see it here.');
                return;
            }
            
            const recipeList = savedRecipes.map(recipe => 
                `üìñ ${recipe.title} (saved ${new Date(recipe.savedAt).toLocaleDateString()})`
            ).join('\n');
            
            alert(`Saved Recipes:\n\n${recipeList}`);
        }

        function viewShoppingList() {
            const shoppingList = JSON.parse(localStorage.getItem('shoppingList') || '[]');
            if (shoppingList.length === 0) {
                alert('Shopping list is empty! Add ingredients from recipes to see them here.');
                return;
            }
            
            const itemList = shoppingList.map(item => 
                `üõí ${item.amount} ${item.unit} ${item.item}`
            ).join('\n');
            
            alert(`Shopping List:\n\n${itemList}`);
        }

        function viewMealPlan() {
            const mealPlan = JSON.parse(localStorage.getItem('mealPlan') || '{}');
            let planText = 'üìÖ Your Meal Plan:\n\n';
            
            const mealTypes = ['breakfast', 'lunch', 'dinner', 'snack'];
            let hasMeals = false;
            
            mealTypes.forEach(mealType => {
                if (mealPlan[mealType] && mealPlan[mealType].length > 0) {
                    hasMeals = true;
                    planText += `${mealType.toUpperCase()}:\n`;
                    mealPlan[mealType].forEach(recipe => {
                        planText += `  üç≥ ${recipe.title}\n`;
                    });
                    planText += '\n';
                }
            });
            
            if (!hasMeals) {
                planText = 'No meals planned yet! Add recipes to your meal plan.';
            }
            
            alert(planText);
        }

        function updateServings(value) {
            servings = parseInt(value);
        }

        function updateCookingTime(value) {
            localStorage.setItem('cookingTime', value);
        }

        function updateCuisine(value) {
            localStorage.setItem('cuisine', value);
        }

        function updateDifficulty(value) {
            localStorage.setItem('difficulty', value);
        }

        // Enhanced recipe display with premium features
        function displayRecipe(recipe) {
            document.getElementById('recipe-title').textContent = recipe.title;
            document.getElementById('recipe-description').textContent = recipe.description;
            
            // Display ingredients (scale for premium users)
            const ingredientsList = document.getElementById('recipe-ingredients');
            ingredientsList.innerHTML = '';
            recipe.ingredients.forEach(ingredient => {
                const li = document.createElement('li');
                li.className = 'flex items-center';
                let amount = ingredient.amount;
                let unit = ingredient.unit;
                
                // Scale ingredients for premium users
                if (isPremium && servings !== 4) {
                    const originalAmount = parseFloat(amount);
                    const scaleFactor = servings / 4;
                    amount = (originalAmount * scaleFactor).toFixed(1);
                    if (amount.endsWith('.0')) amount = amount.slice(0, -2);
                }
                
                li.innerHTML = `
                    <span class="ingredient-tag mr-2">${amount} ${unit}</span>
                    <span class="text-gray-700">${ingredient.item}</span>
                `;
                ingredientsList.appendChild(li);
            });

            // Display instructions
            const instructionsList = document.getElementById('recipe-instructions');
            instructionsList.innerHTML = '';
            recipe.instructions.forEach((instruction, index) => {
                const li = document.createElement('li');
                li.className = 'flex items-start gap-3';
                li.innerHTML = `
                    <div class="step-number">${index + 1}</div>
                    <span class="text-gray-700">${instruction}</span>
                `;
                instructionsList.appendChild(li);
            });

            // Display cooking info with premium enhancements
            document.getElementById('cooking-time').textContent = recipe.cookingTime;
            document.getElementById('servings').textContent = isPremium ? `${servings} servings` : recipe.servings;
            document.getElementById('calories').textContent = recipe.calories;

            // Add premium features to recipe display
            if (isPremium) {
                addPremiumRecipeFeatures(recipe);
            }

            // Add save recipe button for all users
            addSaveRecipeButton(recipe);

            // Show the recipe
            document.getElementById('recipe-display').classList.remove('hidden');
            document.getElementById('recipe-display').scrollIntoView({ behavior: 'smooth' });
        }

        function addSaveRecipeButton(recipe) {
            const recipeCard = document.querySelector('.recipe-card');
            
            // Check if save button already exists
            const existingSaveBtn = recipeCard.querySelector('.save-recipe-btn');
            if (existingSaveBtn) {
                existingSaveBtn.remove();
            }
            
            // Create save button
            const saveButton = document.createElement('button');
            saveButton.className = 'save-recipe-btn btn-primary mt-4 px-6 py-2';
            saveButton.innerHTML = 'Save Recipe';
            saveButton.onclick = () => saveRecipe(recipe);
            
            // Add to recipe card
            recipeCard.appendChild(saveButton);
        }

        function saveRecipe(recipe) {
            const savedRecipes = JSON.parse(localStorage.getItem('savedRecipes') || '[]');
            
            // Check if recipe is already saved
            const existingIndex = savedRecipes.findIndex(saved => saved.title === recipe.title);
            
            if (existingIndex !== -1) {
                if (confirm('This recipe is already saved. Do you want to update it?')) {
                    savedRecipes[existingIndex] = {
                        ...recipe,
                        savedAt: new Date().toISOString(),
                        lastModified: new Date().toISOString()
                    };
                } else {
                    return;
                }
            } else {
                // Add new recipe
                savedRecipes.push({
                    ...recipe,
                    savedAt: new Date().toISOString(),
                    lastModified: new Date().toISOString()
                });
            }
            
            localStorage.setItem('savedRecipes', JSON.stringify(savedRecipes));
            alert('Recipe saved successfully!');
            
            // Update button text
            const saveBtn = document.querySelector('.save-recipe-btn');
            if (saveBtn) {
                saveBtn.innerHTML = 'Saved!';
                saveBtn.disabled = true;
                setTimeout(() => {
                    saveBtn.innerHTML = 'Save Recipe';
                    saveBtn.disabled = false;
                }, 2000);
            }
        }

        function addPremiumRecipeFeatures(recipe) {
            const recipeCard = document.querySelector('.recipe-card');
            
            // Add save recipe button
            const saveButton = document.createElement('button');
            saveButton.className = 'btn-primary mt-4 mr-2';
            saveButton.innerHTML = 'Save Recipe';
            saveButton.onclick = () => saveRecipe(recipe);
            
            // Add share recipe button
            const shareButton = document.createElement('button');
            shareButton.className = 'btn-primary mt-4 mr-2';
            shareButton.innerHTML = 'Share Recipe';
            shareButton.onclick = () => shareRecipe(recipe);
            
            // Add shopping list button
            const shoppingButton = document.createElement('button');
            shoppingButton.className = 'btn-primary mt-4';
            shoppingButton.innerHTML = 'Add to Shopping List';
            shoppingButton.onclick = () => addToShoppingList(recipe);
            
            // Add buttons to recipe card
            const buttonContainer = document.createElement('div');
            buttonContainer.className = 'flex flex-wrap gap-2 mt-6';
            buttonContainer.appendChild(saveButton);
            buttonContainer.appendChild(shareButton);
            buttonContainer.appendChild(shoppingButton);
            
            recipeCard.appendChild(buttonContainer);
            
            // Add nutritional breakdown for premium users
            addNutritionalInfo(recipe);
        }



        function shareRecipe(recipe) {
            const recipeText = `
${recipe.title}

${recipe.description}

Ingredients:
${recipe.ingredients.map(i => `- ${i.amount} ${i.unit} ${i.item}`).join('\n')}

Instructions:
${recipe.instructions.map((step, i) => `${i + 1}. ${step}`).join('\n')}

Cooking Time: ${recipe.cookingTime}
Servings: ${recipe.servings}
Calories: ${recipe.calories}

Shared from Recipe Generator App
            `;
            
            if (navigator.share) {
                navigator.share({
                    title: recipe.title,
                    text: recipeText
                });
            } else {
                navigator.clipboard.writeText(recipeText);
                alert('Recipe copied to clipboard!');
            }
        }

        function addToShoppingList(recipe) {
            const shoppingList = JSON.parse(localStorage.getItem('shoppingList') || '[]');
            recipe.ingredients.forEach(ingredient => {
                shoppingList.push({
                    item: ingredient.item,
                    amount: ingredient.amount,
                    unit: ingredient.unit,
                    addedAt: new Date().toISOString()
                });
            });
            localStorage.setItem('shoppingList', JSON.stringify(shoppingList));
            alert('Ingredients added to shopping list!');
        }

        function addNutritionalInfo(recipe) {
            const nutritionDiv = document.createElement('div');
            nutritionDiv.className = 'mt-6 p-4 bg-pink-50 rounded-lg';
            nutritionDiv.innerHTML = `
                <h4 class="text-lg font-bold text-gray-800 mb-3">Nutritional Information (Premium)</h4>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                    <div class="text-center">
                        <div class="font-bold text-pink-600">${recipe.calories}</div>
                        <div class="text-gray-600">Calories</div>
                    </div>
                    <div class="text-center">
                        <div class="font-bold text-pink-600">12g</div>
                        <div class="text-gray-600">Protein</div>
                    </div>
                    <div class="text-center">
                        <div class="font-bold text-pink-600">8g</div>
                        <div class="text-gray-600">Fat</div>
                    </div>
                    <div class="text-center">
                        <div class="font-bold text-pink-600">45g</div>
                        <div class="text-gray-600">Carbs</div>
                    </div>
                </div>
            `;
            
            const recipeCard = document.querySelector('.recipe-card');
            recipeCard.appendChild(nutritionDiv);
        }

        function viewRecipe(recipeTitle) {
            const savedRecipes = JSON.parse(localStorage.getItem('savedRecipes') || '[]');
            const recipe = savedRecipes.find(r => r.title === recipeTitle);
            
            if (!recipe) {
                alert('Recipe not found!');
                return;
            }
            
            // Go back to main page first
            showMainPage();
            
            // Wait a moment for the page to load, then display the recipe
            setTimeout(() => {
                displayRecipe(recipe);
            }, 100);
        }

        function addIngredientsToShoppingList(recipeTitle) {
            const savedRecipes = JSON.parse(localStorage.getItem('savedRecipes') || '[]');
            const recipe = savedRecipes.find(r => r.title === recipeTitle);
            
            if (!recipe) {
                alert('Recipe not found!');
                return;
            }
            
            const shoppingList = JSON.parse(localStorage.getItem('shoppingList') || '[]');
            
            // Add all ingredients from the recipe
            recipe.ingredients.forEach(ingredient => {
                // Check if ingredient already exists
                const existingIndex = shoppingList.findIndex(item => 
                    item.item.toLowerCase() === ingredient.item.toLowerCase()
                );
                
                if (existingIndex !== -1) {
                    // Update quantity if ingredient exists
                    const existing = shoppingList[existingIndex];
                    const existingAmount = parseFloat(existing.amount);
                    const newAmount = parseFloat(ingredient.amount);
                    shoppingList[existingIndex].amount = (existingAmount + newAmount).toString();
                } else {
                    // Add new ingredient
                    shoppingList.push({
                        item: ingredient.item,
                        amount: ingredient.amount,
                        unit: ingredient.unit,
                        fromRecipe: recipe.title
                    });
                }
            });
            
            localStorage.setItem('shoppingList', JSON.stringify(shoppingList));
            alert(`Added ${recipe.ingredients.length} ingredients from "${recipe.title}" to your shopping list!`);
        }

        function removeRecipe(recipeTitle) {
            const savedRecipes = JSON.parse(localStorage.getItem('savedRecipes') || '[]');
            const recipeIndex = savedRecipes.findIndex(r => r.title === recipeTitle);
            
            if (recipeIndex === -1) {
                alert('Recipe not found!');
                return;
            }
            
            if (confirm(`Are you sure you want to delete "${recipeTitle}" from your saved recipes?`)) {
                savedRecipes.splice(recipeIndex, 1);
                localStorage.setItem('savedRecipes', JSON.stringify(savedRecipes));
                
                // Refresh the saved recipes page
                showSavedRecipesPage();
                
                alert('Recipe deleted successfully!');
            }
        }
    </script>
</body>
</html> 